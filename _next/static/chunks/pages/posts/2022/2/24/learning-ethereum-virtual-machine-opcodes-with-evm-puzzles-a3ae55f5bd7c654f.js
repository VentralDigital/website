(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4655],{47645:function(s,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/2022/2/24/learning-ethereum-virtual-machine-opcodes-with-evm-puzzles",function(){return n(14538)}])},14538:function(s,e,n){"use strict";n.r(e),n.d(e,{__toc:function(){return c}});var l=n(35250),r=n(47147),o=n(77298),i=n(18363),t=n(13423);let c=[{depth:2,value:"Puzzle #1",id:"puzzle-1"},{depth:2,value:"Puzzle #2",id:"puzzle-2"},{depth:2,value:"Puzzle #3",id:"puzzle-3"},{depth:2,value:"Puzzle #4",id:"puzzle-4"},{depth:2,value:"Puzzle #5",id:"puzzle-5"},{depth:2,value:"Puzzle #6",id:"puzzle-6"},{depth:2,value:"Puzzle #7",id:"puzzle-7"},{depth:2,value:"Puzzle #8",id:"puzzle-8"}];function _createMdxContent(s){let e=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",code:"code",pre:"pre",span:"span",ul:"ul",li:"li",hr:"hr"},(0,o.a)(),s.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.h1,{children:"Learning Ethereum Virtual Machine Opcodes With EVM Puzzles"}),"\n",(0,l.jsxs)("p",{className:"text-xs text-right",children:["February 24, 2022 by ",(0,l.jsx)(e.a,{href:"/about#patrickd",children:"patrickd"})]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.a,{href:"https://twitter.com/fvictorio_nan",children:"Franco Victorio"}),", one of the devs from ",(0,l.jsx)(e.a,{href:"https://hardhat.org/",children:"Hardhat"}),', created a collection of "',(0,l.jsx)(e.a,{href:"https://github.com/fvictorio/evm-puzzles",children:"EVM Puzzles"}),"\" that we'll be solving here. Consider attempting them yourself first before getting spoiled!"]}),"\n",(0,l.jsx)(e.h2,{id:"puzzle-1",children:(0,l.jsx)(e.a,{href:"https://github.com/fvictorio/evm-puzzles/blob/master/puzzles/puzzle_1.js",children:"Puzzle #1"})}),"\n",(0,l.jsxs)(e.p,{children:["So first of all, how do these puzzles work? They all consist of the ",(0,l.jsx)(e.code,{children:"puzzleCode"}),", which is a smart contract's binary code, that was annotated with human-readable opcode names as comments. These contracts are deployed and then we can send ",(0,l.jsx)(e.code,{children:"data"})," (calldata) and ",(0,l.jsx)(e.code,{children:"value"})," (wei) to them as part of a transaction. The goal of each puzzle is to create a transaction (by setting data and value) that will succeed (and doesn't revert)."]}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"puzzleCode"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'36'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CALLDATASIZE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'56'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMP"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'5b'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPDEST"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".join"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"''"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:" "}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// Enter your solution here"})}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"solution"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  data"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"0x"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  value"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsxs)(e.p,{children:["The ",(0,l.jsx)(e.a,{href:"https://www.evm.codes/",children:"evm.codes"})," website has a handy table of all existing opcodes and what they do. Of these opcodes we need to prevent the instruction pointer to ever reach a ",(0,l.jsx)(e.code,{children:"REVERT"})," or ",(0,l.jsx)(e.code,{children:"INVALID"}),". Instead, we need it to either reach the end of the code or reach a ",(0,l.jsx)(e.code,{children:"STOP"})," operation."]}),"\n",(0,l.jsxs)(e.p,{children:["When our ",(0,l.jsx)(e.code,{children:"solution"})," is sent as a transaction to the contract's address, the EVM will always begin executing it with the instruction pointer on the first opcode. In the first puzzle that would be the ",(0,l.jsx)(e.code,{children:"CALLDATASIZE"})," opcode. This pushes the length of our solution's ",(0,l.jsx)(e.code,{children:"data"})," field onto the stack."]}),"\n",(0,l.jsxs)(e.p,{children:["The ",(0,l.jsx)(e.code,{children:"JUMP"}),' instruction tells the EVM to have the instruction pointer "jump" to another location in the bytecode. It gets this location by popping off the first value from the stack. It\'s important to note that only offsets where the ',(0,l.jsx)(e.code,{children:"JUMPDEST"})," opcode is located are valid jumping targets."]}),"\n",(0,l.jsxs)(e.p,{children:["So knowing that we can now see that we have to influence the value that ",(0,l.jsx)(e.code,{children:"CALLDATA"})," pushes onto the stack to ensure that ",(0,l.jsx)(e.code,{children:"JUMP"})," makes the program continue at ",(0,l.jsx)(e.code,{children:"JUMPDEST"})," reaching the valid end of bytecode. In this case, we can determine the offset of ",(0,l.jsx)(e.code,{children:"JUMPDEST"})," simply by counting the number instructions, it's at 8 (start counting at 0) and that's also the number of bytes we have to send as ",(0,l.jsx)(e.code,{children:"data"}),"."]}),"\n",(0,l.jsx)(e.p,{children:"To check this solution, edit it like this:"}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"solution"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  data"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"0x0000000000000000"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  value"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.p,{children:"And then execute the script:"}),"\n",(0,l.jsx)(e.pre,{"data-language":"bash","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"bash","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"ubuntu@evmpuzzles:~/evm-puzzles$"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"npx"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"hardhat"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"run"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"puzzles/puzzle_1.js"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Puzzle"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"solved!"})]})]})}),"\n",(0,l.jsx)(e.h2,{id:"puzzle-2",children:(0,l.jsx)(e.a,{href:"https://github.com/fvictorio/evm-puzzles/blob/master/puzzles/puzzle_2.js",children:"Puzzle #2"})}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"puzzleCode"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'36'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CALLDATASIZE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'38'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CODESIZE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'03'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// SUB"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'56'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMP"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'5b'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPDEST"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".join"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"''"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,l.jsxs)(e.p,{children:["This puzzle introduces the ",(0,l.jsx)(e.code,{children:"CODESIZE"})," opcode which simply puts the size of the current contract's bytecode on top of the stack. Once deployed this value is static, and in this case we can once again simply count the number of instructions which is 9, and once again the ",(0,l.jsx)(e.code,{children:"JUMPDEST"})," location is at 8."]}),"\n",(0,l.jsxs)(e.p,{children:["The ",(0,l.jsx)(e.code,{children:"SUB"})," instruction subtracts the second value, from the stack, off the first one. In this case the stack would look like ",(0,l.jsx)(e.code,{children:"[CODESIZE, CALLDATASIZE]"})," before the subtraction and ",(0,l.jsx)(e.code,{children:"[CODESIZE - CALLDATASIZE]"})," after, because both values were popped off and the result was pushed on."]}),"\n",(0,l.jsxs)(e.p,{children:["This means we have to solve the following: ",(0,l.jsx)(e.code,{children:"9 - CALLDATASIZE = 8"})," - and to do that we simply send a single byte as data. This will leave the value 8 on top of the stack and just like last time the ",(0,l.jsx)(e.code,{children:"JUMP"})," can do its job."]}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"solution"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  data"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"0x00"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  value"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.h2,{id:"puzzle-3",children:(0,l.jsx)(e.a,{href:"https://github.com/fvictorio/evm-puzzles/blob/master/puzzles/puzzle_3.js",children:"Puzzle #3"})}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"puzzleCode"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'6000'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PUSH1 00"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'35'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CALLDATALOAD"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'56'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMP"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'5b'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPDEST"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".join"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"''"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,l.jsxs)(e.p,{children:["The new ",(0,l.jsx)(e.code,{children:"PUSH1"})," instruction simply pushes a single byte on top of the stack, the byte that follows immediately after the instruction in the bytecode: ",(0,l.jsx)(e.code,{children:"00"}),". This zero value is then consumed by ",(0,l.jsx)(e.code,{children:"CALLDATALOAD"})," as an offset of where to start reading the call data. It reads 32 bytes from our transaction ",(0,l.jsx)(e.code,{children:"data"})," and pushes it onto the stack. If it finds less than 32 bytes to copy it will add zeros as padding to reach that length."]}),"\n",(0,l.jsxs)(e.p,{children:["So whatever we send as calldata here will get pushed onto the stack and then consumed by ",(0,l.jsx)(e.code,{children:"JUMP"}),". This means we simply have to send the correct offset for the jump destination as data, which is 10 in this case or ",(0,l.jsx)(e.code,{children:"0x0a"})," in hexadecimal. But since this would become ",(0,l.jsx)(e.code,{children:"0x0a00000000000000000000000000000000000000000000000000000000000000"})," after padding, which is a ",(0,l.jsx)(e.a,{href:"https://eth-toolbox.com/?target=evm-words&evm-value=0x0a00000000000000000000000000000000000000000000000000000000000000#bp-evm-words",children:"really large number"}),", we have to make sure to send the full 32 byte word with ",(0,l.jsx)(e.code,{children:"0x0a"})," being the least significant byte."]}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"solution"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  data"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"0x000000000000000000000000000000000000000000000000000000000000000a"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  value"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.h2,{id:"puzzle-4",children:(0,l.jsx)(e.a,{href:"https://github.com/fvictorio/evm-puzzles/blob/master/puzzles/puzzle_4.js",children:"Puzzle #4"})}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"puzzleCode"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'6000'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PUSH1 00"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'35'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CALLDATALOAD"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'38'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CODESIZE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'18'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// XOR"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'56'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMP"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'5b'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPDEST"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".join"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"''"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,l.jsxs)(e.p,{children:["The ",(0,l.jsx)(e.code,{children:"XOR"})," opcode is similar to ",(0,l.jsx)(e.code,{children:"SUB"}),", it takes two inputs from the stack, applies the exclusive-or operation on them, finally pushing the result back."]}),"\n",(0,l.jsxs)(e.p,{children:["What's effectively happening here is the following: ",(0,l.jsx)(e.code,{children:"jumpTo(calldata ^ codesize)"}),". And the location we want to jump to is 12 (",(0,l.jsx)(e.code,{children:"0x0c"}),") while the codesize is 13 (",(0,l.jsx)(e.code,{children:"0x0d"}),"). This means we have to solve ",(0,l.jsx)(e.code,{children:"calldata ^ 0x0d = 0x0c"})," which we can by doing ",(0,l.jsx)(e.code,{children:"0x0d ^ 0x0c = calldata = 0x01"}),"."]}),"\n",(0,l.jsxs)(e.p,{children:["Sending a 32 byte word with a value of 1, will be XORed with 13, which results in 12, pointing to the correct ",(0,l.jsx)(e.code,{children:"JUMPDEST"}),":"]}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"solution"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  data"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"0x0000000000000000000000000000000000000000000000000000000000000001"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  value"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.h2,{id:"puzzle-5",children:(0,l.jsx)(e.a,{href:"https://github.com/fvictorio/evm-puzzles/blob/master/puzzles/puzzle_5.js",children:"Puzzle #5"})}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"puzzleCode"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'34'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CALLVALUE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'610004'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PUSH2 0004"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'01'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// ADD"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'56'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMP"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'5b'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPDEST"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".join"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"''"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,l.jsxs)(e.p,{children:["This time the puzzle uses the ",(0,l.jsx)(e.code,{children:"value"}),", which is the amount of wei, sent with the transaction, instead of the transaction ",(0,l.jsx)(e.code,{children:"data"})," itself. ",(0,l.jsx)(e.code,{children:"CALLVALUE"})," simply pushes this amount of wei onto the stack. After that a ",(0,l.jsx)(e.code,{children:"PUSH2"})," operation pushes the two bytes following it onto the stack: ",(0,l.jsx)(e.code,{children:"0004"})," or simply a 4."]}),"\n",(0,l.jsxs)(e.p,{children:["You have probably already guessed that ",(0,l.jsx)(e.code,{children:"ADD"})," stands for addition. In pseudocode this puzzle can be rewritten as ",(0,l.jsx)(e.code,{children:"jumpTo(value + 4)"}),". The ",(0,l.jsx)(e.code,{children:"JUMPDEST"})," is at offset 10, which means we need to send 6 wei to make it jump there."]}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"solution"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  data"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"0x"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  value"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"6"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.h2,{id:"puzzle-6",children:(0,l.jsx)(e.a,{href:"https://github.com/fvictorio/evm-puzzles/blob/master/puzzles/puzzle_6.js",children:"Puzzle #6"})}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"puzzleCode"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'34'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CALLVALUE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'80'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// DUP1"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'02'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// MUL"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'6009'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PUSH1 09"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'14'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// EQ"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'600d'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PUSH1 0d"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'57'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPI"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'5b'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPDEST"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".join"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"''"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,l.jsxs)(e.p,{children:["A whole bunch of new opcodes are introduced in this puzzle. Starting with the easiest one, ",(0,l.jsx)(e.code,{children:"MUL"})," which is the opcode for multiplication and works just like ",(0,l.jsx)(e.code,{children:"SUB"}),", ",(0,l.jsx)(e.code,{children:"ADD"})," and ",(0,l.jsx)(e.code,{children:"XOR"})," did. ",(0,l.jsx)(e.code,{children:"EQ"})," is also quite similar, but instead of calculating with the first two stack items, it compares them and pushes a ",(0,l.jsx)(e.code,{children:"1"})," if they're equal and otherwise a ",(0,l.jsx)(e.code,{children:"0"})," back onto the stack."]}),"\n",(0,l.jsxs)(e.p,{children:["Then there's ",(0,l.jsx)(e.code,{children:"DUP1"})," which simply duplicates the first stack item. For example if your stack looks like ",(0,l.jsx)(e.code,{children:"[1, 2, 3]"})," it will be ",(0,l.jsx)(e.code,{children:"[1, 1, 2, 3]"})," after ",(0,l.jsx)(e.code,{children:"DUP1"})," was executed."]}),"\n",(0,l.jsxs)(e.p,{children:["Finally there's ",(0,l.jsx)(e.code,{children:"JUMPI"})," which is a conditional ",(0,l.jsx)(e.code,{children:"JUMP"}),". Additionally to the destination offset, it consumes another stack item and checks whether it equals 0. If it's anything other than 0 it will jump to the location specified by the first stack item."]}),"\n",(0,l.jsx)(e.p,{children:"The puzzle can be rewritten like this:"}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" (value "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" value "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"9"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"jumpTo"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0x0d"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsxs)(e.p,{children:["This time the correct jump destination is already hardcoded. Instead, we have to specify a value of wei to send which ensures that ",(0,l.jsx)(e.code,{children:"JUMPI"})," does jump at all. And as you can already tell from the pseudocode, that value must be 3."]}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"solution"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  data"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"0x"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  value"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"3"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.p,{children:"To easier understand what's happening, here's how the stack changes after each instruction:"}),"\n",(0,l.jsx)(e.pre,{"data-language":"bash","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"bash","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x00"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"CALLVALUE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       [3]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x01"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"DUP1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            [3, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x02"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"MUL"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"             [9]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x03"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"PUSH1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"09"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        [9, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"9"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x05"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"EQ"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"              [1]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x06"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"PUSH1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"d"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        [0x0d, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x08"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"JUMPI"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"           []            ---"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x09"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"REVERT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                           "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0a"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"REVERT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                           "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0b"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"REVERT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                           "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0c"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"REVERT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                           "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0d"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"JUMPDEST"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        []            "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"--"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"STOP"})]})]})}),"\n",(0,l.jsx)(e.h2,{id:"puzzle-7",children:(0,l.jsx)(e.a,{href:"https://github.com/fvictorio/evm-puzzles/blob/master/puzzles/puzzle_7.js",children:"Puzzle #7"})}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"puzzleCode"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'36'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CALLDATASIZE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'6003'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PUSH1 03"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'10'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// LT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'6009'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PUSH1 09"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'57'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPI"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'5b'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPDEST"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'34'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CALLVALUE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'36'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CALLDATASIZE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'02'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// MUL"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'6008'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PUSH1 08"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'14'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// EQ"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'6014'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PUSH1 14"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'57'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPI"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'5b'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPDEST"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".join"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"''"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,l.jsxs)(e.p,{children:["This puzzle is quite a bit more complex but it only introduces one new opcode: ",(0,l.jsx)(e.code,{children:"LT"})," or lower-than, is similar to ",(0,l.jsx)(e.code,{children:"EQ"})," in that it compares the first two items on stack and pushes 1 or 0 as a result:"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"[1, 2]"})," - ",(0,l.jsx)(e.code,{children:"1 < 2"}),"? - Yes (",(0,l.jsx)(e.code,{children:"1"}),")"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"[2, 1]"})," - ",(0,l.jsx)(e.code,{children:"2 < 1"}),"? - No (",(0,l.jsx)(e.code,{children:"0"}),")"]}),"\n"]}),"\n",(0,l.jsxs)(e.p,{children:["The first part of the puzzle (until the first ",(0,l.jsx)(e.code,{children:"REVERT"}),"s) can be rewritten like this:"]}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"CALLDATASIZE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"jumpTo"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0x09"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.p,{children:"The second part like this:"}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"CALLDATASIZE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"CALLVALUE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"8"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"jumpTo"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0x14"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.p,{children:"Since the length of our calldata must be greater than 3, and when multiplied with the value it must result in 8, it must be that we have to send 4 bytes and 2 wei."}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"solution"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  data"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"0x00000000"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  value"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"2"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.p,{children:"Let's once again see how this transaction is actually being executed within the EVM:"}),"\n",(0,l.jsx)(e.pre,{"data-language":"bash","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"bash","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x00"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"CALLDATASIZE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   [4]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x01"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"PUSH1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"03"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       [3, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"4"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x03"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"LT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"             [1]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x04"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"PUSH1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"09"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       [0x09, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x06"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"JUMPI"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"          []            ---"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x07"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"REVERT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                          "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x08"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"REVERT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                          "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x09"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"JUMPDEST"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       []            "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"--"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0a"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"CALLVALUE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      [2]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0b"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"CALLDATASIZE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   [4, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"2"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0c"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"MUL"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            [8]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0d"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"PUSH1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"08"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       [8, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"8"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0f"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"EQ"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"             [1]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x10"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"PUSH1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"14"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       [0x14, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x12"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"JUMPI"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"          []            ---"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x13"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"REVERT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                          "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x14"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"JUMPDEST"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       []            "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"--"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"STOP"})]})]})}),"\n",(0,l.jsx)(e.h2,{id:"puzzle-8",children:(0,l.jsx)(e.a,{href:"https://github.com/fvictorio/evm-puzzles/blob/master/puzzles/puzzle_8.js",children:"Puzzle #8"})}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"puzzleCode"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'38'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CODESIZE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'34'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CALLVALUE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'90'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// SWAP1"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'11'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// GT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'6008'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PUSH1 08"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'57'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPI"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'5b'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPDEST"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'36'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CALLDATASIZE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'610003'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PUSH2 03"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'90'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// SWAP1"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'06'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// MOD"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'15'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// ISZERO"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'34'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// CALLVALUE"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'600a'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// PUSH1 0a"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'01'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// ADD"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'57'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPI"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'fdfd'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// REVERT REVERT"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'5b'"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// JUMPDEST"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".join"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"''"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]})]})}),"\n",(0,l.jsxs)(e.p,{children:["It doesn't take much to guess that ",(0,l.jsx)(e.code,{children:"GT"})," indeed stands for greater-than and works just like ",(0,l.jsx)(e.code,{children:"LT"}),". And yet another comparing opcode is introduced with ",(0,l.jsx)(e.code,{children:"ISZERO"}),", but this one only consumes one item of the stack's top and pushes a ",(0,l.jsx)(e.code,{children:"1"})," or a ",(0,l.jsx)(e.code,{children:"0"})," depending whether that value was a zero or not."]}),"\n",(0,l.jsxs)(e.p,{children:["Next is the ",(0,l.jsx)(e.code,{children:"MOD"})," operator, which allows calculation of the modulo and works just like the other arithmetic instructions."]}),"\n",(0,l.jsxs)(e.p,{children:["The use of ",(0,l.jsx)(e.code,{children:"SWAP1"})," in this puzzle appears to have been added for creating confusion by switching the first two value of the stack around (eg. [1, 2] becomes [2, 1])."]}),"\n",(0,l.jsx)(e.p,{children:"With that in mind, puzzle can again be broken down into two parts:"}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"CODESIZE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"CALLVALUE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"jumpTo"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0x08"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"CALLDATASIZE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"%"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"jumpTo"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0x0a"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"+"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"CALLVALUE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsxs)(e.p,{children:["The size of the bytecode is a static value of 26, and the first condition is that the sent wei value is smaller than that. It's also required that ",(0,l.jsx)(e.code,{children:"CALLDATASIZE % 3 = 0"}),", which means we can send any length of data as long as it's a multiple of 3 - let's just send 3 bytes!"]}),"\n",(0,l.jsxs)(e.p,{children:["The final ",(0,l.jsx)(e.code,{children:"JUMPDEST"})," is at offset 0x19 and depends on the wei value sent: ",(0,l.jsx)(e.code,{children:"0x0a + CALLVALUE = 0x19"})," (or simply ",(0,l.jsx)(e.code,{children:"10 + 15 = 25"}),"). Sending 15 wei is also smaller than 26 and therefore passing the first condition as well."]}),"\n",(0,l.jsx)(e.pre,{"data-language":"javascript","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"javascript","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"solution"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  data"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"0x000000"'}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  value"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"15"})]}),"\n",(0,l.jsx)(e.span,{className:"line",children:(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(e.p,{children:"Once more, step by step:"}),"\n",(0,l.jsx)(e.pre,{"data-language":"bash","data-theme":"default",children:(0,l.jsxs)(e.code,{"data-language":"bash","data-theme":"default",children:[(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x00"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"CODESIZE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      [26]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x01"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"CALLVALUE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     [15, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"26"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x02"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"SWAP1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"         [26, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"15"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x03"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"GT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            [1]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x04"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"PUSH1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"08"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      [0x08, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x06"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"JUMPI"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"         []            ---"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x07"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"REVERT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                         "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x08"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"JUMPDEST"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      []            "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"--"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x09"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"CALLDATASIZE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  [3]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0a"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"PUSH2"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0003"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    [3, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0d"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"SWAP1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"         [3, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"3"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0e"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"MOD"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"           [0]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x0f"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"ISZERO"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        [1]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x10"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"CALLVALUE"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     [15, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x11"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"PUSH1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"a"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      [0x0a, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"15"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:","}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x13"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"ADD"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"           [0x18, "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"]"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x14"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"JUMPI"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"         []            ---"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x15"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"REVERT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                         "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x16"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"REVERT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                         "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x17"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"REVERT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                         "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x18"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"REVERT"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                         "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"0x19"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"JUMPDEST"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      []            "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"--"}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"})]}),"\n",(0,l.jsxs)(e.span,{className:"line",children:[(0,l.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,l.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"STOP"})]})]})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.p,{children:"That's it already! Although these puzzles were rather simple they were still good fun and I'm looking forward to solving more of them in the future."}),"\n",(0,l.jsx)(e.hr,{}),"\n","\n",(0,l.jsx)(i.oy,{children:(0,l.jsx)(i.Zb,{icon:(0,l.jsx)(t.aA,{}),title:"EVM Puzzles – Second Wind →",href:"/posts/2022/3/12/evm-puzzles-second-wind/"})})]})}e.default=(0,r.j)({MDXContent:function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,o.a)(),s.components);return e?(0,l.jsx)(e,{...s,children:(0,l.jsx)(_createMdxContent,{...s})}):_createMdxContent(s)},pageOpts:{filePath:"pages/posts/2022/2/24/learning-ethereum-virtual-machine-opcodes-with-evm-puzzles.mdx",route:"/posts/2022/2/24/learning-ethereum-virtual-machine-opcodes-with-evm-puzzles",timestamp:1702204664e3,title:"Learning Ethereum Virtual Machine Opcodes With EVM Puzzles",headings:c},pageNextRoute:"/posts/2022/2/24/learning-ethereum-virtual-machine-opcodes-with-evm-puzzles"})}},function(s){s.O(0,[3220,1589,9774,2888,179],function(){return s(s.s=47645)}),_N_E=s.O()}]);