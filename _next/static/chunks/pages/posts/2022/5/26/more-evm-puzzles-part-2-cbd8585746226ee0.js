(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9001],{51664:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/2022/5/26/more-evm-puzzles-part-2",function(){return l(91566)}])},91566:function(e,s,l){"use strict";l.r(s),l.d(s,{__toc:function(){return c}});var n=l(35250),a=l(47147),t=l(77298),i=l(18363),r=l(13423);let c=[{depth:2,value:"Puzzle #3",id:"puzzle-3"},{depth:4,value:"Runtime Bytecode",id:"runtime-bytecode"},{depth:4,value:"Construction Bytecode",id:"construction-bytecode"},{depth:4,value:"Solution",id:"solution"},{depth:2,value:"Puzzle #4",id:"puzzle-4"}];function _createMdxContent(e){let s=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",pre:"pre",code:"code",span:"span",h4:"h4",hr:"hr"},(0,t.a)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{children:"More EVM Puzzles - Part 2"}),"\n",(0,n.jsxs)("p",{className:"text-xs text-right",children:["May 26, 2022 by ",(0,n.jsx)(s.a,{href:"/about#patrickd",children:"patrickd"})]}),"\n",(0,n.jsxs)(s.p,{children:["This continues the series on ",(0,n.jsx)(s.a,{href:"https://twitter.com/DaltonSweeney9",children:"Dalton Sweeney"}),"'s ",(0,n.jsx)(s.a,{href:"https://github.com/daltyboy11/more-evm-puzzles",children:'"10 more EVM puzzles"'})," collection. If you haven't read it yet, you should probably check out ",(0,n.jsx)(s.a,{href:"/posts/2022/5/24/more-evm-puzzles-part-1",children:"Part 1"})," first."]}),"\n",(0,n.jsx)(s.h2,{id:"puzzle-3",children:"Puzzle #3"}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"plaintext","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"00      36        CALLDATASIZE"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"01      6000      PUSH1 00"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"03      6000      PUSH1 00"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"05      37        CALLDATACOPY"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"06      36        CALLDATASIZE"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"07      6000      PUSH1 00"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"09      6000      PUSH1 00"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0B      F0        CREATE"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0C      6000      PUSH1 00"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0E      80        DUP1"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0F      80        DUP1"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"10      80        DUP1"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"11      93        SWAP4"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"12      5A        GAS"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"13      F4        DELEGATECALL"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"14      6005      PUSH1 05"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"16      54        SLOAD"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"17      60AA      PUSH1 AA"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"19      14        EQ"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"1A      601E      PUSH1 1E"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"1C      57        JUMPI"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"1D      FE        INVALID"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"1E      5B        JUMPDEST"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"1F      00        STOP"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"? Enter the calldata:"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["Just like in the previous puzzle, there's only one ",(0,n.jsx)(s.code,{children:"JUMPDEST"})," we have to reach located at offset ",(0,n.jsx)(s.code,{children:"0x1E"})," and all we have to make sure to get there is, that the ",(0,n.jsx)(s.code,{children:"EQ"})," comparison before the ",(0,n.jsx)(s.code,{children:"JUMP"})," succeeds."]}),"\n",(0,n.jsxs)(s.p,{children:["This is actually the first time that storage is touched during these puzzles: ",(0,n.jsx)(s.code,{children:"SLOAD"}),' will consume one item from the stack as "key" and push the "value" it found there to stack. It\'s a simple read operation from a key-value store.']}),"\n",(0,n.jsxs)(s.p,{children:["We can see that the jump-condition can be written as: ",(0,n.jsx)(s.code,{children:"SLOAD(0x05) == 0xAA"}),", basically we have to make sure that the value for the storage key ",(0,n.jsx)(s.code,{children:"0x05"})," equals ",(0,n.jsx)(s.code,{children:"0xAA"}),". There's no ",(0,n.jsx)(s.code,{children:"SSTORE"})," opcode writing to storage though, but there is a ",(0,n.jsx)(s.code,{children:"DELEGATECALL"}),", meaning that we can run code of another smart contract on our context, which includes storage."]}),"\n",(0,n.jsxs)(s.p,{children:["The entire first part of the bytecode before the ",(0,n.jsx)(s.code,{children:"CREATE"})," opcode is the same as before, so we'll again be able to deploy a contract via the calldata we send. Similarly, the bytecode before the ",(0,n.jsx)(s.code,{children:"DELEGATECALL"})," is almost the same as it was for the ",(0,n.jsx)(s.code,{children:"CALL"})," in the previous puzzle. The only difference is that one less ",(0,n.jsx)(s.code,{children:"0x00"})," is duplicated, because there's no \"value\" to send here - that wouldn't make sense since any wei we send with the call would end up at the same contract again due to delegation."]}),"\n",(0,n.jsxs)(s.p,{children:["In summary: We have to send construction bytecode that returns runtime bytecode of a contract that'll store the value ",(0,n.jsx)(s.code,{children:"0xAA"})," at the key ",(0,n.jsx)(s.code,{children:"0x05"}),". After it was deployed that runtime bytecode will be delegate-called and we'll write to the puzzle's storage instead of the storage of the contract that was deployed. This storage value is then checked and if it was correctly set we'll successfully jump to the end."]}),"\n",(0,n.jsx)(s.h4,{id:"runtime-bytecode",children:"Runtime Bytecode"}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"plaintext","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"00      60AA      PUSH1 AA        [0xAA]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"02      6005      PUSH1 05        [0x05, 0x0A] (key, value)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"04      55        SSTORE          []"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["This time we don't actually have to ",(0,n.jsx)(s.code,{children:"RETURN"})," anything, instead we can just ",(0,n.jsx)(s.code,{children:"STOP"})," (which is implicit at the end of bytecode) after writing to storage."]}),"\n",(0,n.jsxs)(s.p,{children:["Runtime bytecode: ",(0,n.jsx)(s.code,{children:"0x60AA600555"})]}),"\n",(0,n.jsx)(s.h4,{id:"construction-bytecode",children:"Construction Bytecode"}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"plaintext","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"00      6460AA600555      PUSH5 60AA600555        [0x60AA600555]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"06      6000              PUSH1 00                [0x0, 0x60AA600555] (offset, value)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"08      52                MSTORE                  []"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"00      600A              PUSH1 0A                [0x0A]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"02      601B              PUSH1 1B                [0x1B, 0x0A] (offset, size)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"04      F3                RETURN                  []"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["Like last time, we write the runtime bytecode to memory so we can ",(0,n.jsx)(s.code,{children:"RETURN"})," it during initiation."]}),"\n",(0,n.jsxs)(s.p,{children:["Construction Bytecode: ",(0,n.jsx)(s.code,{children:"0x6460AA600555600052600A601BF3"})]}),"\n",(0,n.jsx)(s.h4,{id:"solution",children:"Solution"}),"\n",(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"? Enter the calldata: 0x6460AA600555600052600A601BF3"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"Puzzle solved!"})})]})}),"\n",(0,n.jsx)(s.p,{children:"This was relatively easy to solve since we could mostly re-purpose the simple solution from Puzzle #2."}),"\n",(0,n.jsx)(s.h2,{id:"puzzle-4",children:"Puzzle #4"}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"plaintext","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"00      30        ADDRESS"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"01      31        BALANCE"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"02      36        CALLDATASIZE"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"03      6000      PUSH1 00"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"05      6000      PUSH1 00"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"07      37        CALLDATACOPY"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"08      36        CALLDATASIZE"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"09      6000      PUSH1 00"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0B      30        ADDRESS"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0C      31        BALANCE"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0D      F0        CREATE"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0E      31        BALANCE"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0F      90        SWAP1"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"10      04        DIV"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"11      6002      PUSH1 02"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"13      14        EQ"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"14      6018      PUSH1 18"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"16      57        JUMPI"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"17      FD        REVERT"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"18      5B        JUMPDEST"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"19      00        STOP"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"? Enter the value to send:"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"? Enter the calldata:"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["We can see a new combination of opcodes here: First ",(0,n.jsx)(s.code,{children:"ADDRESS"})," which pushes the puzzle contract's own address onto the stack, and then ",(0,n.jsx)(s.code,{children:"BALANCE"})," which consumes this address and returns the amount of ether the account at said address has, in this case: The puzzle's balance which we can manipulate by sending value when prompted."]}),"\n",(0,n.jsxs)(s.p,{children:["Ignoring the first balance that is pushed onto the stack, what follows is the same ",(0,n.jsx)(s.code,{children:"CREATE"})," operation as in the previous puzzles with the only difference that this time the entire puzzle's balance is forwarded to the contract being created."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"plaintext","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"00      30        ADDRESS         [AddressOfPuzzle]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"01      31        BALANCE         [BalanceOfPuzzle]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"...                               Balance of Puzzle is sent to new contract..."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0D      F0        CREATE          [AddressOfNewContract, OldBalanceOfPuzzle]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0E      31        BALANCE         [BalanceOfNewContract, OldBalanceOfPuzzle]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0F      90        SWAP1           [OldBalanceOfPuzzle, BalanceOfNewContract]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"10      04        DIV             [OldBalanceOfPuzzle//BalanceOfNewContract]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"11      6002      PUSH1 02        [0x02, OldBalanceOfPuzzle//BalanceOfNewContract]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"13      14        EQ              [OldBalanceOfPuzzle//BalanceOfNewContract == 0x02]"})})]})}),"\n",(0,n.jsx)(s.p,{children:"Immediately after, the returned address of the newly created contract is then consumed to obtain its balance. The old balance of the puzzle is then integer-divided by the current balance of the new contract and the result of this division must be 2 in order for the jump to happen. But without doing anything the result would currently always be 1."}),"\n",(0,n.jsx)(s.p,{children:"So to solve this puzzle the construction bytecode we send as calldata has to send away half of its balance. For example, if we send 4 wei to the puzzle, our contract receiving them has to burn 2 wei so that 4//2 == 2. The construction bytecode doesn't have to return any runtime bytecode since that's not necessary for it to simply hold on the the remaining balance."}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"plaintext","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0C      6000      PUSH1 00        [0x0]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0E      80        DUP1            [0x0, 0x0]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0E      80        DUP1            [0x0, 0x0, 0x0]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0F      80        DUP1            [0x0, 0x0, 0x0, 0x0]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0C      6002      PUSH1 02        [2, 0x0, 0x0, 0x0, 0x0]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"11      81        DUP2            [0x0, 2, 0x0, 0x0, 0x0, 0x0]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"13      5A        GAS             [GAS, 0x0, 2, 0x0, 0x0, 0x0, 0x0] (gas, address, value, argsOffset, argsSize, retOffset, retSize)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"00      F1        CALL            []"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"07      6000      PUSH1 00        [0x0]"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"09      80        DUP1            [0x0, 0x0] (offset, size)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0B      F3        RETURN          []"})})]})}),"\n",(0,n.jsx)(s.p,{children:"The above construction bytecode sends 2 wei to the 0x0 address in order to burn it and then returns nothing as runtime bytecode."}),"\n",(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"? Enter the value to send: 4"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"? Enter the calldata: 0x60008080806002815AF1600080F3"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"Puzzle solved!"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["Initially I forgot that the old balance of the puzzle is used. Assuming that it's the current one I thought about having to send some of the balance back to the puzzle. Since sending value with ",(0,n.jsx)(s.code,{children:"CALL"})," would trigger the puzzle's bytecode again though the only way to do that would be deploying another contract that uses ",(0,n.jsx)(s.code,{children:"SELFDESTRUCT"})," to inject value into the puzzle without that happening. Surprised by how convoluted this solution seemed, I later noticed the challenge was actually way easier than that - took me a while though."]}),"\n",(0,n.jsx)(s.hr,{}),"\n","\n",(0,n.jsxs)(i.oy,{children:[(0,n.jsx)(i.Zb,{icon:(0,n.jsx)(r.aA,{}),title:"← More EVM Puzzles - Part 1",href:"/posts/2022/5/24/more-evm-puzzles-part-1/"}),(0,n.jsx)(i.Zb,{icon:(0,n.jsx)(r.aA,{}),title:"More EVM Puzzles - Part 3 →",href:"/posts/2022/6/6/more-evm-puzzles-part-3/"})]})]})}s.default=(0,a.j)({MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,t.a)(),e.components);return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/posts/2022/5/26/more-evm-puzzles-part-2.mdx",route:"/posts/2022/5/26/more-evm-puzzles-part-2",timestamp:1702204664e3,title:"More EVM Puzzles - Part 2",headings:c},pageNextRoute:"/posts/2022/5/26/more-evm-puzzles-part-2"})}},function(e){e.O(0,[3220,1589,9774,2888,179],function(){return e(e.s=51664)}),_N_E=e.O()}]);