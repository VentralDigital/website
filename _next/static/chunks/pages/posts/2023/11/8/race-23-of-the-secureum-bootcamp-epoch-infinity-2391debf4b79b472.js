(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3867],{30281:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/2023/11/8/race-23-of-the-secureum-bootcamp-epoch-infinity",function(){return n(97977)}])},64751:function(e,s){"use strict";s.Z={src:"/_next/static/media/secureum-banner.b3ad8557.jpg",height:630,width:1200,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCAAEAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAbEAACAgMBAAAAAAAAAAAAAAAAAgEDBCEyE//EABUBAQEAAAAAAAAAAAAAAAAAAAQF/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAECEf/aAAwDAQACEQMRAD8AnGFcviyPjUWS1PTJuOtgAcT9auj/2Q==",blurWidth:8,blurHeight:4}},97977:function(e,s,n){"use strict";n.r(s),n.d(s,{HiddenSolution:function(){return HiddenSolution},__toc:function(){return p}});var l=n(35250),i=n(65910),o=n.n(i),r=n(47147),t=n(77298),a=n(18363),c=n(30746),h=n.n(c),d=n(64751),x=n(13423);function HiddenSolution(e){let{children:s}=e,n=Object.assign({details:"details",summary:"summary",strong:"strong",div:"div"},(0,t.a)());return(0,l.jsxs)(n.details,{closed:!0,className:"last-of-type:mb-0 rounded-lg bg-neutral-50 dark:bg-neutral-800 p-2 mt-4",children:[(0,l.jsx)(n.summary,{children:(0,l.jsx)(n.strong,{className:"text-lg",children:"Solution"})}),(0,l.jsx)(n.div,{className:"nx-p-2",children:s})]})}let p=[{depth:3,value:"Code",id:"code"},{depth:3,value:"Question 1 of 8",id:"question-1-of-8"},{depth:3,value:"Question 2 of 8",id:"question-2-of-8"},{depth:3,value:"Question 3 of 8",id:"question-3-of-8"},{depth:3,value:"Question 4 of 8",id:"question-4-of-8"},{depth:3,value:"Question 5 of 8",id:"question-5-of-8"},{depth:3,value:"Question 6 of 8",id:"question-6-of-8"},{depth:3,value:"Question 7 of 8",id:"question-7-of-8"},{depth:3,value:"Question 8 of 8",id:"question-8-of-8"}];function _createMdxContent(e){let s=Object.assign({h1:"h1",p:"p",a:"a",strong:"strong",em:"em",hr:"hr",h3:"h3",pre:"pre",code:"code",span:"span",ul:"ul",li:"li"},(0,t.a)(),e.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.h1,{children:"RACE #23 Of The Secureum Bootcamp Epoch∞"}),"\n","\n",(0,l.jsxs)(h(),{children:[(0,l.jsx)("meta",{property:"og:image",content:"https://ventral.digital"+d.Z.src,className:"jsx-ea2c409626c7be76"}),(0,l.jsx)("meta",{name:"twitter:image",content:"https://ventral.digital"+d.Z.src,className:"jsx-ea2c409626c7be76"})]}),"\n",(0,l.jsxs)(a.UW,{type:"info",children:[(0,l.jsxs)(s.p,{children:["This is a mirror of a Write-Up on RACE-23, Quiz of the ",(0,l.jsx)(s.a,{href:"https://twitter.com/0xRajeev/status/1470910752085065731",children:"Secureum Bootcamp"})," for Ethereum Smart Contract Auditors. It was designed by Secureum Mentor ",(0,l.jsx)(s.a,{href:"https://twitter.com/FormallyJon",children:"Jon Stephens"}),", from ",(0,l.jsx)(s.a,{href:"https://twitter.com/VeridiseInc",children:"Veridise"}),"."]}),(0,l.jsxs)(s.p,{children:["The original version of this document can be found at ",(0,l.jsx)(s.a,{href:"https://veridise.notion.site/veridise/RACE-23-Answers-d63cb0b5373f43f0ba43612e89596547",children:"https://veridise.notion.site/veridise/RACE-23-Answers-d63cb0b5373f43f0ba43612e89596547"})]}),(0,l.jsxs)(s.p,{children:["Participants of this quiz had to ",(0,l.jsxs)(s.strong,{children:["answer 8 questions within the strict time limit of ",(0,l.jsx)(s.em,{children:"64 minutes"})]})," on Zero Knowledge, Circom, and Merkle Trees. If you’re reading this in preparation for participating yourself, it’s best to give it a try under the same time limit!"]})]}),"\n",(0,l.jsx)(o(),{id:"ea2c409626c7be76",children:"input[type=checkbox].jsx-ea2c409626c7be76{width:15px;height:15px}li.jsx-ea2c409626c7be76{padding:.5em}"}),"\n","\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h3,{id:"code",children:"Code"}),"\n",(0,l.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",filename:"tree.circom",children:(0,l.jsxs)(s.code,{"data-line-numbers":"","data-language":"plaintext","data-theme":"default","data-line-numbers-max-digits":"3",children:[(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'include "circomlib/circuits/poseidon.circom";'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'include "circomlib/circuits/bitify.circom";'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"template Mux() {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input in[2];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input s;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal output out[2];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    out[0] <-- (s == 0) ? in[0] : in[1];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    out[1] <-- (s == 0) ? in[1] : in[0];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"template ComputeTreeRoot(nLevels) {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input leaf;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input indices[nLevels];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input siblings[nLevels];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal output root;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    component muxes[nLevels];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    component hashers[nLevels];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal hashes[nLevels + 1];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    hashes[0] <-- leaf;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    for (var i = 0; i < nLevels; i++) {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        hashers[i] = Poseidon(2);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        muxes[i] = Mux();"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        muxes[i].in[0] <== hashes[i];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        muxes[i].in[1] <== siblings[i];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        muxes[i].s <== indices[i];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        hashers[i].inputs[0] <== muxes[i].out[0];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        hashers[i].inputs[1] <== muxes[i].out[1];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        hashes[i + 1] <== hashers[i].out;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    hashes[0] === leaf;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    root <== hashes[nLevels];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// treeAdd.circom"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'include "circomlib/circuits/poseidon.circom";'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'include "circomlib/circuits/bitify.circom";'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'include "./tree.circom";'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"template MerkleTreeAdd(nLevels) {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input oldVal;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input amount;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input index;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input siblings[nLevels];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input oldRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal output newRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal output nullifier;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    component indexBits = Num2Bits(nLevels);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    indexBits.in <== index;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    component newRootCalc = ComputeTreeRoot(nLevels);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    component oldRootCalc = ComputeTreeRoot(nLevels);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    oldRootCalc.leaf <== oldVal;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    newRootCalc.leaf <== oldVal + amount;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    for (var i = 0; i < nLevels; i++) {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        oldRootCalc.siblings[i] <== siblings[i];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        oldRootCalc.indices[i] <== indexBits.out[i];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        newRootCalc.siblings[i] <== siblings[i];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        newRootCalc.indices[i] <== indexBits.out[i];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    oldRootCalc.root === oldRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    newRoot <== newRootCalc.root;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    component nullifierHash = Poseidon(1);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    nullifierHash.inputs[0] <== oldVal + amount;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    nullifier <== nullifierHash.out;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"component main {public [oldRoot, index, amount]} = MerkleTreeAdd(32);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// treeSub.circom"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'include "circomlib/circuits/poseidon.circom";'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'include "circomlib/circuits/bitify.circom";'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'include "./tree.circom";'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"template MerkleTreeSub(nLevels) {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input oldVal;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input amount;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input index;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input siblings[nLevels];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal input oldRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal output newRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    signal output nullifier;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    component indexBits = Num2Bits(nLevels);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    indexBits.in <== index;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    component newRootCalc = ComputeTreeRoot(nLevels);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    component oldRootCalc = ComputeTreeRoot(nLevels);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    oldRootCalc.leaf <== oldVal;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    newRootCalc.leaf <== oldVal - amount;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    for (var i = 0; i < nLevels; i++) {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        oldRootCalc.siblings[i] <== siblings[i];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        oldRootCalc.indices[i] <== indexBits.out[i];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        newRootCalc.siblings[i] <== siblings[i];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        newRootCalc.indices[i] <== indexBits.out[i];"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    oldRootCalc.root === oldRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    newRoot <== newRootCalc.root;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    component nullifierHash = Poseidon(1);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    nullifierHash.inputs[0] <== oldVal - amount;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    nullifier <== nullifierHash.out;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"component main {public [oldRoot, index, amount]} = MerkleTreeSub(32);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// PrivateToken.sol"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// SPDX-License-Identifier: MIT"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"pragma solidity ^0.8.15;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// Invokes verifier generated by snarkjs"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"interface IVerifier {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function verifyAdd(uint256 oldRoot, uint256 index, uint256 amount, uint256 newRoot, uint256 nullifier, uint256[8] calldata proof) external returns (bool);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function verifySub(uint256 oldRoot, uint256 index, uint256 amount, uint256 newRoot, uint256 nullifier, uint256[8] calldata proof) external returns (bool);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"contract PrivateToken {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    mapping(uint256 => bool) usedNullifiers;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    uint256 public root;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    IVerifier verifier;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    address minter;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    struct OperationProof {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        uint256 oldRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        uint256 index;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        uint256 amount;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        uint256 newRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        uint256 nullifier;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        uint256[8] proof;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    event Mint(uint256 oldRoot, uint256 index, uint256 amount, uint256 newRoot, uint256 nullifier);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    event Burn(uint256 oldRoot, uint256 index, uint256 amount, uint256 newRoot, uint256 nullifier);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    event Transfer(uint256 oldRoot, uint256 from, uint256 to, uint256 amount, uint256 newRoot, uint256 fromNullifier, uint256 toNullifier);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    constructor(address v, address m) {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        // root of tree with height of 32 and 0s for each leaf"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        root = 19057105225525447794058879360670244229202611178388892366137113354909512903676;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        verifier = IVerifier(v);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        minter = m;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function burn(OperationProof calldata subProof) external {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(!usedNullifiers[subProof.nullifier]);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        usedNullifiers[subProof.nullifier] = true;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        root = subProof.newRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(verifier.verifySub(subProof.oldRoot, subProof.index, subProof.amount, subProof.newRoot, subProof.nullifier, subProof.proof));"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        emit Burn(subProof.oldRoot, subProof.index, subProof.amount, subProof.newRoot, subProof.nullifier);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function mint(OperationProof calldata addProof) external {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(msg.sender == minter);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(!usedNullifiers[addProof.nullifier]);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        usedNullifiers[addProof.nullifier] = true;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        root = addProof.newRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(verifier.verifyAdd(addProof.oldRoot, addProof.index, addProof.amount, addProof.newRoot, addProof.nullifier, addProof.proof));"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        emit Mint(addProof.oldRoot, addProof.index, addProof.amount, addProof.newRoot, addProof.nullifier);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function transfer(OperationProof calldata addProof, OperationProof calldata subProof) external {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(addProof.amount == subProof.amount);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(!usedNullifiers[addProof.nullifier]);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        usedNullifiers[addProof.nullifier] = true;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(!usedNullifiers[subProof.nullifier]);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        usedNullifiers[subProof.nullifier] = true;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(verifier.verifyAdd(addProof.oldRoot, addProof.index, addProof.amount, addProof.newRoot, addProof.nullifier, addProof.proof));"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(verifier.verifySub(subProof.oldRoot, subProof.index, subProof.amount, subProof.newRoot, subProof.nullifier, subProof.proof));"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(addProof.oldRoot == subProof.newRoot || addProof.newRoot == subProof.oldRoot);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        uint256 oldRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        if(addProof.oldRoot == subProof.newRoot) {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            oldRoot = subProof.oldRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            root = addProof.newRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        else {"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            oldRoot = addProof.oldRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            root = subProof.newRoot;"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        emit Transfer(oldRoot, subProof.index, addProof.index, addProof.amount, root, subProof.nullifier, addProof.nullifier);"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h3,{id:"question-1-of-8",children:"Question 1 of 8"}),"\n",(0,l.jsxs)(s.p,{children:["A call to ",(0,l.jsx)(s.code,{children:"PrivateToken.transfer"})," may revert for which, if any, of the following reasons?"]}),"\n",(0,l.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The current root does not match either ",(0,l.jsx)(s.code,{children:"addProof.oldRoot"})," or ",(0,l.jsx)(s.code,{children:"subProof.oldRoot"}),". "]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. The amounts declared in ",(0,l.jsx)(s.code,{children:"addProof"})," and ",(0,l.jsx)(s.code,{children:"subProof"})," do not match. "]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. A nullifier has been used in the past. "]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Either ",(0,l.jsx)(s.code,{children:"addProof"})," or ",(0,l.jsx)(s.code,{children:"subProof"})," does not verify. "]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," E. None of the above "]})]}),"\n",(0,l.jsxs)(HiddenSolution,{children:[(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Correct Picks: B, C, D."})}),(0,l.jsx)(s.p,{children:"B, C and D all correspond to requires in burn, but there is no root check so A must be false"})]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h3,{id:"question-2-of-8",children:"Question 2 of 8"}),"\n",(0,l.jsxs)(s.p,{children:["Which, if any, of the following statements hold with respect to ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd"}),"?"]}),"\n",(0,l.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd"})," circuit will only verify computations where ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd.oldVal"})," is in the merkle tree with root ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd.oldRoot"}),"."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. The ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd"})," circuit will only verify computations where the leaf is at the location given by ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd.index"})," in the merkle tree with root ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd.oldRoot"}),"."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. The ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd"})," circuit will only verify computations where the root calculated by ",(0,l.jsx)(s.code,{children:"ComputeTreeRoot"})," matches ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd.oldRoot"}),"."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. The ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd"})," circuit will only verify computations where the sum of ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd.oldVal"})," and ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd.amount"})," are in the merkle tree with root ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd.newRoot"}),"."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," E. None of the above"]})]}),"\n",(0,l.jsxs)(HiddenSolution,{children:[(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Correct Picks: C."})}),(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"A is not correct because of the unconstrained mux."}),"\n",(0,l.jsx)(s.li,{children:"B is not correct for the same reason."}),"\n",(0,l.jsxs)(s.li,{children:["C is correct because of a check in ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd"}),", which ensures the root matches."]}),"\n",(0,l.jsx)(s.li,{children:"D is not correct because of the unconstrained mux."}),"\n"]})]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h3,{id:"question-3-of-8",children:"Question 3 of 8"}),"\n",(0,l.jsx)(s.p,{children:"Which, if any, of the following statements hold with respect to a user's balance?"}),"\n",(0,l.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The balance associated with a user's ID is private and cannot be known after funds have been allocated to it."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. A user must know the balance associated with an ID to spend funds from it."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. An index in the merkle tree is tied to a specific address so the associated balance corresponds to that address's balance."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. If the root of the tree doesn't change, a user can always show that their balance is contained in the tree."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," E. None of the above"]})]}),"\n",(0,l.jsxs)(HiddenSolution,{children:[(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Correct Picks: D."})}),(0,l.jsx)(s.p,{children:"There are two privacy leaks that allow someone to learn a user's balance, so A is not correct. B is not correct because of the unconstrained mux. C is not correct because there is no logic that ties an address to an index. D is correct because if the root has not changed, then someone's merkle proof must remain valid."})]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h3,{id:"question-4-of-8",children:"Question 4 of 8"}),"\n",(0,l.jsx)(s.p,{children:"Which, if any, of the following statements hold with respect to how a user's balance may change?"}),"\n",(0,l.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Upon a burn, a user's balance will either decrease or remain the same."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Upon a mint, a user's balance will either increase or remain the same."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Upon a transfer, the sum of user balances stored in the tree is constant."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. During a mint, burn and transfer, only the balances at the indicated indices will change."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," E. None of the above"]})]}),"\n",(0,l.jsxs)(HiddenSolution,{children:[(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Correct Picks: E."})}),(0,l.jsx)(s.p,{children:"None of these hold since the balance values may overflow and the unconstrained mux."})]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h3,{id:"question-5-of-8",children:"Question 5 of 8"}),"\n",(0,l.jsx)(s.p,{children:"Which, if any, of the following signals are under-constrained (i.e. a signal may be assigned to at least two different values while keeping the circuit inputs constant)?"}),"\n",(0,l.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. ",(0,l.jsx)(s.code,{children:"MerkleTreeSub.newRoot"})," "]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. ",(0,l.jsx)(s.code,{children:"ComputeTreeRoot.hashes[0]"})," "]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. ",(0,l.jsx)(s.code,{children:"MerkleTreeAdd.nullifier"})," "]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. ",(0,l.jsx)(s.code,{children:"MerkleTreeSub.oldRootCalc.root"})," "]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," E. None of the above "]})]}),"\n",(0,l.jsxs)(HiddenSolution,{children:[(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Correct Picks: A."})}),(0,l.jsxs)(s.p,{children:["A is under-constrained because of the unconstrained mux. B is not under-constrained because of the ",(0,l.jsx)(s.code,{children:"==="})," constraint at the end of the circuit. C is not underconstrained due to ",(0,l.jsx)(s.code,{children:"<=="}),". Finally, D is not under-constrained since it is explicitly constrained to an input in ",(0,l.jsx)(s.code,{children:"MerkleTreeSub"}),"."]})]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h3,{id:"question-6-of-8",children:"Question 6 of 8"}),"\n",(0,l.jsx)(s.p,{children:"Which, if any, of the following may occur during a burn?"}),"\n",(0,l.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. A user may burn more funds than they own."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. The new computed root will not be saved."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. The balances stored in the merkle tree may be arbitrarily manipulated."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Every user can burn their entire balance."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," E. None of the above"]})]}),"\n",(0,l.jsxs)(HiddenSolution,{children:[(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Correct Picks: A, C."})}),(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"A holds due to the overflow."}),"\n",(0,l.jsx)(s.li,{children:"B does not hold since burn does store the new root."}),"\n",(0,l.jsx)(s.li,{children:"C holds due to the under-constrained mux."}),"\n",(0,l.jsx)(s.li,{children:"D does not hold since the nullifier is tied to user balances, so only one user may have balance 0."}),"\n"]})]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h3,{id:"question-7-of-8",children:"Question 7 of 8"}),"\n",(0,l.jsx)(s.p,{children:"With respect to the nullifier, which, if any, of the following statements hold?"}),"\n",(0,l.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The nullifier leaks information about a user's balance."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. The nullifier will prevent users from submitting the same proof twice."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. If a nullifier is used by some user, another user will likely not be affected."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. The computed value of the nullifier is under-constrained."]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," E. None of the above"]})]}),"\n",(0,l.jsxs)(HiddenSolution,{children:[(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Correct Picks: A,B."})}),(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"A holds because it hashes the balance directly and so if two nullifiers conflict,\xa0 you have learned something about the balance of the user who used it previously."}),"\n",(0,l.jsx)(s.li,{children:"B is correct since the same proof will result in the same balance and therefore the same nullifier."}),"\n",(0,l.jsx)(s.li,{children:"C is not correct due to the issue identified in A."}),"\n",(0,l.jsx)(s.li,{children:"D is not correct because the nullifier is explicitly constrained to be the hash of two input values."}),"\n"]})]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h3,{id:"question-8-of-8",children:"Question 8 of 8"}),"\n",(0,l.jsx)(s.p,{children:"Which, if any, of the following correspond to potential attacks that can be used against the protocol?"}),"\n",(0,l.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Replay Attack"]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Denial of Service"]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Under-constrained Signal Manipulation"]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Arithmetic Overflow"]}),(0,l.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,l.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," E. None of the above"]})]}),"\n",(0,l.jsxs)(HiddenSolution,{children:[(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Correct Picks: B, C, D."})}),(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"As discussed in Q7, you cannot replay proofs so A is not correct."}),"\n",(0,l.jsx)(s.li,{children:"B is correct due to the balance issue from Q6, someone can perform a Dos."}),"\n",(0,l.jsx)(s.li,{children:"C is correct as there are under-constrained signals that impact the output of the circuit."}),"\n",(0,l.jsx)(s.li,{children:"D is correct since since the balance add and sub may overflow."}),"\n"]})]}),"\n",(0,l.jsx)(s.hr,{}),"\n","\n",(0,l.jsxs)(a.oy,{children:[(0,l.jsx)(a.Zb,{icon:(0,l.jsx)(x.H8,{}),title:"← RACE #22 Of The Secureum Bootcamp Epoch∞",href:"/posts/2023/10/3/race-22-of-the-secureum-bootcamp-epoch-infinity/"}),(0,l.jsx)(a.Zb,{icon:(0,l.jsx)(x.H8,{}),title:"RACE #24 Of The Secureum Bootcamp Epoch∞ →",href:"/posts/2023/12/17/race-24-of-the-secureum-bootcamp-epoch-infinity"})]})]})}s.default=(0,r.j)({MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,t.a)(),e.components);return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/posts/2023/11/8/race-23-of-the-secureum-bootcamp-epoch-infinity.mdx",route:"/posts/2023/11/8/race-23-of-the-secureum-bootcamp-epoch-infinity",timestamp:1731290394e3,title:"RACE #23 Of The Secureum Bootcamp Epoch∞",headings:p},pageNextRoute:"/posts/2023/11/8/race-23-of-the-secureum-bootcamp-epoch-infinity"})},96139:function(e,s,n){var l=n(94869);n(26228);var i=n(70079),o=i&&"object"==typeof i&&"default"in i?i:{default:i};function _defineProperties(e,s){for(var n=0;n<s.length;n++){var l=s[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}var r=void 0!==l&&l.env&&!0,isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},t=function(){function StyleSheet(e){var s=void 0===e?{}:e,n=s.name,l=void 0===n?"stylesheet":n,i=s.optimizeForSpeed,o=void 0===i?r:i;invariant$1(isString(l),"`name` must be a string"),this._name=l,this._deletedRulePlaceholder="#"+l+"-deleted-rule____{}",invariant$1("boolean"==typeof o,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=o,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var t=document.querySelector('meta[property="csp-nonce"]');this._nonce=t?t.getAttribute("content"):null}var e,s=StyleSheet.prototype;return s.setOptimizeForSpeed=function(e){invariant$1("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),invariant$1(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},s.isOptimizeForSpeed=function(){return this._optimizeForSpeed},s.inject=function(){var e=this;if(invariant$1(!this._injected,"sheet already injected"),this._injected=!0,this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(r||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(s,n){return"number"==typeof n?e._serverSheet.cssRules[n]={cssText:s}:e._serverSheet.cssRules.push({cssText:s}),n},deleteRule:function(s){e._serverSheet.cssRules[s]=null}}},s.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].ownerNode===e)return document.styleSheets[s]},s.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},s.insertRule=function(e,s){if(invariant$1(isString(e),"`insertRule` accepts only strings"),this._optimizeForSpeed){var n=this.getSheet();"number"!=typeof s&&(s=n.cssRules.length);try{n.insertRule(e,s)}catch(s){return r||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var l=this._tags[s];this._tags.push(this.makeStyleTag(this._name,e,l))}return this._rulesCount++},s.replaceRule=function(e,s){if(this._optimizeForSpeed){var n=this.getSheet();if(s.trim()||(s=this._deletedRulePlaceholder),!n.cssRules[e])return e;n.deleteRule(e);try{n.insertRule(s,e)}catch(l){r||console.warn("StyleSheet: illegal rule: \n\n"+s+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),n.insertRule(this._deletedRulePlaceholder,e)}}else{var l=this._tags[e];invariant$1(l,"old rule at index `"+e+"` not found"),l.textContent=s}return e},s.deleteRule=function(e){if(this._optimizeForSpeed)this.replaceRule(e,"");else{var s=this._tags[e];invariant$1(s,"rule at index `"+e+"` not found"),s.parentNode.removeChild(s),this._tags[e]=null}},s.flush=function(){this._injected=!1,this._rulesCount=0,this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]},s.cssRules=function(){var e=this;return this._tags.reduce(function(s,n){return n?s=s.concat(Array.prototype.map.call(e.getSheetForTag(n).cssRules,function(s){return s.cssText===e._deletedRulePlaceholder?null:s})):s.push(null),s},[])},s.makeStyleTag=function(e,s,n){s&&invariant$1(isString(s),"makeStyleTag accepts only strings as second parameter");var l=document.createElement("style");this._nonce&&l.setAttribute("nonce",this._nonce),l.type="text/css",l.setAttribute("data-"+e,""),s&&l.appendChild(document.createTextNode(s));var i=document.head||document.getElementsByTagName("head")[0];return n?i.insertBefore(l,n):i.appendChild(l),l},_defineProperties(StyleSheet.prototype,[{key:"length",get:function(){return this._rulesCount}}]),e&&_defineProperties(StyleSheet,e),StyleSheet}();function invariant$1(e,s){if(!e)throw Error("StyleSheet: "+s+".")}var stringHash=function(e){for(var s=5381,n=e.length;n;)s=33*s^e.charCodeAt(--n);return s>>>0},a={};function computeId(e,s){if(!s)return"jsx-"+e;var n=String(s),l=e+n;return a[l]||(a[l]="jsx-"+stringHash(e+"-"+n)),a[l]}function computeSelector(e,s){var n=e+s;return a[n]||(a[n]=s.replace(/__jsx-style-dynamic-selector/g,e)),a[n]}var c=function(){function StyleSheetRegistry(e){var s=void 0===e?{}:e,n=s.styleSheet,l=void 0===n?null:n,i=s.optimizeForSpeed,o=void 0!==i&&i;this._sheet=l||new t({name:"styled-jsx",optimizeForSpeed:o}),this._sheet.inject(),l&&"boolean"==typeof o&&(this._sheet.setOptimizeForSpeed(o),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var e=StyleSheetRegistry.prototype;return e.add=function(e){var s=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,s){return e[s]=0,e},{}));var n=this.getIdAndRules(e),l=n.styleId,i=n.rules;if(l in this._instancesCounts){this._instancesCounts[l]+=1;return}var o=i.map(function(e){return s._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[l]=o,this._instancesCounts[l]=1},e.remove=function(e){var s=this,n=this.getIdAndRules(e).styleId;if(function(e,s){if(!e)throw Error("StyleSheetRegistry: "+s+".")}(n in this._instancesCounts,"styleId: `"+n+"` not found"),this._instancesCounts[n]-=1,this._instancesCounts[n]<1){var l=this._fromServer&&this._fromServer[n];l?(l.parentNode.removeChild(l),delete this._fromServer[n]):(this._indices[n].forEach(function(e){return s._sheet.deleteRule(e)}),delete this._indices[n]),delete this._instancesCounts[n]}},e.update=function(e,s){this.add(s),this.remove(e)},e.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},e.cssRules=function(){var e=this,s=this._fromServer?Object.keys(this._fromServer).map(function(s){return[s,e._fromServer[s]]}):[],n=this._sheet.cssRules();return s.concat(Object.keys(this._indices).map(function(s){return[s,e._indices[s].map(function(e){return n[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},e.styles=function(e){var s,n;return s=this.cssRules(),void 0===(n=e)&&(n={}),s.map(function(e){var s=e[0],l=e[1];return o.default.createElement("style",{id:"__"+s,key:"__"+s,nonce:n.nonce?n.nonce:void 0,dangerouslySetInnerHTML:{__html:l}})})},e.getIdAndRules=function(e){var s=e.children,n=e.dynamic,l=e.id;if(n){var i=computeId(l,n);return{styleId:i,rules:Array.isArray(s)?s.map(function(e){return computeSelector(i,e)}):[computeSelector(i,s)]}}return{styleId:computeId(l),rules:Array.isArray(s)?s:[s]}},e.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,s){return e[s.id.slice(2)]=s,e},{})},StyleSheetRegistry}(),h=i.createContext(null);h.displayName="StyleSheetContext";var d=o.default.useInsertionEffect||o.default.useLayoutEffect,x=new c;function JSXStyle(e){var s=x||i.useContext(h);return s&&d(function(){return s.add(e),function(){s.remove(e)}},[e.id,String(e.dynamic)]),null}JSXStyle.dynamic=function(e){return e.map(function(e){return computeId(e[0],e[1])}).join(" ")},s.style=JSXStyle},65910:function(e,s,n){"use strict";e.exports=n(96139).style},26228:function(){}},function(e){e.O(0,[3220,1589,9774,2888,179],function(){return e(e.s=30281)}),_N_E=e.O()}]);