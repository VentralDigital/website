(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[777],{60319:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/2023/7/30/race-20-of-the-secureum-bootcamp-epoch-infinity",function(){return t(86277)}])},64751:function(e,s){"use strict";s.Z={src:"/_next/static/media/secureum-banner.b3ad8557.jpg",height:630,width:1200,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCAAEAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAbEAACAgMBAAAAAAAAAAAAAAAAAgEDBCEyE//EABUBAQEAAAAAAAAAAAAAAAAAAAQF/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAECEf/aAAwDAQACEQMRAD8AnGFcviyPjUWS1PTJuOtgAcT9auj/2Q==",blurWidth:8,blurHeight:4}},86277:function(e,s,t){"use strict";t.r(s),t.d(s,{HiddenSolution:function(){return HiddenSolution},__toc:function(){return p}});var n=t(35250),i=t(65910),r=t.n(i),a=t(47147),l=t(77298),o=t(18363),c=t(30746),h=t.n(c),d=t(64751),x=t(13423);function HiddenSolution(e){let{children:s}=e,t=Object.assign({details:"details",summary:"summary",strong:"strong",div:"div"},(0,l.a)());return(0,n.jsxs)(t.details,{closed:!0,className:"last-of-type:mb-0 rounded-lg bg-neutral-50 dark:bg-neutral-800 p-2 mt-4",children:[(0,n.jsx)(t.summary,{children:(0,n.jsx)(t.strong,{className:"text-lg",children:"Solution"})}),(0,n.jsx)(t.div,{className:"nx-p-2",children:s})]})}let p=[{depth:3,value:"Code",id:"code"},{depth:3,value:"Question 1 of 8",id:"question-1-of-8"},{depth:3,value:"Question 2 of 8",id:"question-2-of-8"},{depth:3,value:"Question 3 of 8",id:"question-3-of-8"},{depth:3,value:"Question 4 of 8",id:"question-4-of-8"},{depth:3,value:"Question 5 of 8",id:"question-5-of-8"},{depth:3,value:"Question 6 of 8",id:"question-6-of-8"},{depth:3,value:"Question 7 of 8",id:"question-7-of-8"},{depth:3,value:"Question 8 of 8",id:"question-8-of-8"}];function _createMdxContent(e){let s=Object.assign({h1:"h1",p:"p",a:"a",strong:"strong",hr:"hr",h3:"h3",pre:"pre",code:"code",span:"span",ul:"ul",li:"li"},(0,l.a)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{children:"RACE #20 Of The Secureum Bootcamp Epoch∞"}),"\n","\n",(0,n.jsxs)(h(),{children:[(0,n.jsx)("meta",{property:"og:image",content:"https://ventral.digital"+d.Z.src,className:"jsx-ea2c409626c7be76"}),(0,n.jsx)("meta",{name:"twitter:image",content:"https://ventral.digital"+d.Z.src,className:"jsx-ea2c409626c7be76"})]}),"\n",(0,n.jsxs)(s.p,{children:["This is a Write-Up of RACE-12, Quiz of the ",(0,n.jsx)(s.a,{href:"https://twitter.com/0xRajeev/status/1470910752085065731",children:"Secureum Bootcamp"})," for Ethereum Smart Contract Auditors.   This one was designed by none other than ",(0,n.jsx)(s.a,{href:"https://twitter.com/_hrkrshnn",children:"Hari (@hrkrshnn)"}),", Secureum Mentor and Co-Founder of Spearbit. With his background in working on the Solidity compiler this one was sure to be a doozy…"]}),"\n",(0,n.jsxs)(o.UW,{type:"info",children:[(0,n.jsxs)(s.p,{children:["Before tackling this race, participants were recommended to review EVM basics as well as spend some time understanding inline-assembly. Aside from that, it’s the usual ",(0,n.jsx)(s.strong,{children:"8 questions within the strict time limit of 16 minutes"}),"."]}),(0,n.jsx)(s.p,{children:"As always, I waited for submissions to close before publishing it and, to stay true to the original, I omitted syntax highlighting. Feel free to copy it into your favorite editor, but do so after starting the timer!"})]}),"\n",(0,n.jsxs)("p",{className:"jsx-ea2c409626c7be76 text-xs text-right",children:["July 27, 2023 by ",(0,n.jsx)(s.a,{href:"/about#patrickd",children:"patrickd"})]}),"\n",(0,n.jsx)(r(),{id:"ea2c409626c7be76",children:"input[type=checkbox].jsx-ea2c409626c7be76{width:15px;height:15px}li.jsx-ea2c409626c7be76{padding:.5em}"}),"\n","\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"code",children:"Code"}),"\n",(0,n.jsx)(o.UW,{type:"info",children:(0,n.jsx)(s.p,{children:"The first four questions are based on the below library:"})}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-line-numbers":"","data-language":"plaintext","data-theme":"default","data-line-numbers-max-digits":"2",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// SPDX-License-Identifier: MIT"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"pragma solidity >=0.8.0;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"/// @notice Efficient library for creating string representations of integers."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"/// @author Solmate (https://github.com/Rari-Capital/solmate/blob/v7/src/utils/LibString.sol)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"library LibString {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function toString(uint256 n) internal pure returns (string memory str) {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'        if (n == 0) return "0"; // Otherwise it\'d output an empty string for 0.'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        assembly {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            let k := 78 // Start with the max length a uint256 string could be."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // We'll store our string at the first chunk of free memory."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            str := mload(0x40)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // The length of our string will start off at the max of 78."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            mstore(str, k)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // Update the free memory pointer to prevent overriding our string."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // Add 128 to the str pointer instead of 78 because we want to maintain"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // the Solidity convention of keeping the free memory pointer word aligned."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            mstore(0x40, add(str, 128))"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // We'll populate the string from right to left."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // prettier-ignore"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            for {} n {} {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                // The ASCII digit offset for '0' is 48."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                let char := add(48, mod(n, 10))"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                // Write the current character into str."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                mstore(add(str, k), char)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                k := sub(k, 1)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                n := div(n, 10)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // Shift the pointer to the start of the string."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            str := add(str, k)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // Set the length of the string to the correct value."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            mstore(str, sub(78, k))"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsx)(s.h3,{id:"question-1-of-8",children:"Question 1 of 8"}),"\n",(0,n.jsx)(s.p,{children:"Select all true statements:"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The inline assembly block is ",(0,n.jsx)(s.code,{children:"memory-safe"})]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. The memory after ",(0,n.jsx)(s.code,{children:"toString(...)"})," call is always 32-byte aligned"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Instead of allocating memory from 0x40, the function can allocate from 0x0 to save gas (memory expansion cost) and still be correct"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. None of the above"]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is A."})}),(0,n.jsxs)(s.p,{children:["A: The inline assembly block is indeed ",(0,n.jsx)(s.a,{href:"https://docs.soliditylang.org/en/latest/assembly.html#memory-safety",children:"memory-safe"}),', as it only writes to allowed memory ranges. In this specific case it always allocates memory starting from the free memory pointer. A "pointer" is an address within memory and the free memory pointer is the address pointing to the start of unallocated, free memory. This pointer itself is stored in memory at address 0x40 and, unless the value that was just stored in memory is temporary, it should be updated to skip over any recently allocated memory.']}),(0,n.jsx)(s.p,{children:"B: While the memory itself is allocated in chunks of 32-byte slots, the values within these slots will not be properly aligned to each slot. First, note that each string stored in memory consists of two components: The first 32 bytes of a string are always its length. After the length, each further 32 bytes slot will contain part of the actual string's value. Therefore, if you want a pointer to the beginning of a string, you have to add 32 bytes to the string's pointer."}),(0,n.jsxs)(s.p,{children:["Step #0: Initial memory state before ",(0,n.jsx)(s.code,{children:"toString(1)"})," is executed"]}),(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x00 0x0000000000000000000000000000000000000000000000000000000000000000 scratch space"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x20 0x0000000000000000000000000000000000000000000000000000000000000000 scratch space"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x40 0x0000000000000000000000000000000000000000000000000000000000000080 free memory pointer"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x60 0x0000000000000000000000000000000000000000000000000000000000000000 zero slot"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x80 0x0000000000000000000000000000000000000000000000000000000000000000 (unallocated free memory)"})})]})}),(0,n.jsx)(s.p,{children:"Step #1: Memory pointer was updated and initial length of string was written"}),(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x00 0x0000000000000000000000000000000000000000000000000000000000000000 scratch space"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x20 0x0000000000000000000000000000000000000000000000000000000000000000 scratch space"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x40 0x0000000000000000000000000000000000000000000000000000000000000100 free memory pointer (increased by 128)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x60 0x0000000000000000000000000000000000000000000000000000000000000000 zero slot"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x80 0x000000000000000000000000000000000000000000000000000000000000004E string length (78)"})})]})}),(0,n.jsxs)(s.p,{children:["Step #2: The ",(0,n.jsx)(s.code,{children:"char"}),' for "1" is determined to be 0x31 (48+1), its value is then stored to (',(0,n.jsx)(s.code,{children:"str + k"}),") 0x80 + 0x4E = 0xCE"]}),(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x00 0x0000000000000000000000000000000000000000000000000000000000000000 scratch space"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x20 0x0000000000000000000000000000000000000000000000000000000000000000 scratch space"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x40 0x0000000000000000000000000000000000000000000000000000000000000100 free memory pointer (increased by 128)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x60 0x0000000000000000000000000000000000000000000000000000000000000000 zero slot"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x80 0x000000000000000000000000000000000000000000000000000000000000004E string length (78)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xA0 0x0000000000000000000000000000000000000000000000000000000000000000 1st part of string"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xC0 0x0000000000000000000000000000000000000000000000000000000000000000 2nd part of string"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xE0 0x0000000000000000000000000031000000000000000000000000000000000000 3rd part of string (and trailing unused zero bytes)"})})]})}),(0,n.jsxs)(s.p,{children:["Remember that ",(0,n.jsx)(s.code,{children:"MSTORE"})," writes chunks of 32 bytes, so when it writes 0x31 to 0xCE the byte carrying the value will end up in 0xE0's slot because of all the leading zeros (",(0,n.jsx)(s.code,{children:"0x0000000000000000000000000000000000000000000000000000000000000031"}),"). The number is being converted to a string from right to left. If it would be done the other way around, previous numbers to the left would be overwritten by the following character being placed in memory. By doing it right to left, the ",(0,n.jsx)(s.code,{children:"MSTORE"}),"s won't impact the characters already written on the right."]}),(0,n.jsxs)(s.p,{children:["But this is also why a short number such as 1 would end up with many leading zero-bytes in front of it. To prevent this from happening, the ",(0,n.jsx)(s.code,{children:"str"})," reference variable is updated to point to the 32 bytes before the string starts – causing the string's start to no longer be aligned with the beginning of a 32 byte slot. This is the place where finally the string's length will be set at:"]}),(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x00 0x0000000000000000000000000000000000000000000000000000000000000000 scratch space"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x20 0x0000000000000000000000000000000000000000000000000000000000000000 scratch space"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x40 0x0000000000000000000000000000000000000000000000000000000000000100 free memory pointer (increased by 128)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x60 0x0000000000000000000000000000000000000000000000000000000000000000 zero slot"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x80 0x000000000000000000000000000000000000000000000000000000000000004E old string length (78), no longer used"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xA0 0x0000000000000000000000000000000000000000000000000000000000000000 unused but reserved memory"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xC0 0x0000000000000000000000000000000000000000000000000000000000000000 partially the string length"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xE0 0x0000000000000000000000000131000000000000000000000000000000000000 string length (1) and the single char"})})]})}),(0,n.jsxs)(s.p,{children:["C: The 64 bytes starting at memory address 0x0 are called the \"scratch space\". While they're usually used for operations like hashing, you're free to use them to temporarily store things there and leave them without having to clean them up. But there's no guarantee that anything placed in scratch space will remain there for long as any other part of the contract may use it for temporary operations as well. This function's purpose would be harmed if the returned string would be overwritten at random, therefore, while it may safe gas to attempt doing so, it cannot be said that it would still be correct to use the memory at 0x0 instead of allocating fresh dedicated memory. Furthermore, for the largest ",(0,n.jsx)(s.code,{children:"uint256"}),", this function requires more memory than the 64-byte scratch space can offer."]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-2-of-8",children:"Question 2 of 8"}),"\n",(0,n.jsxs)(s.p,{children:["Select all true statements about the expression ",(0,n.jsx)(s.code,{children:"mstore(0x40, add(str, 128))"}),":"]}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The expression allocated more memory than required. The value 128 can be replaced by 96."]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. The expression allocates less memory than required. The value 128 can be replaced by 160."]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. The expression is redundant and can be removed to save gas"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. The expression is not ",(0,n.jsx)(s.code,{children:"‘memory-safe’"})," assembly in this context"]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is B."})}),(0,n.jsx)(s.p,{children:"A/B: While the expression allocates sufficient memory to ensure that later allocations won't overwrite the string, there's still an issue of dirty memory being returned when the actual string contents are read once the memory after the string is in use:"}),(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x00  0x0000000000000000000000000000000000000000000000000000000000000000 scratch space"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x20  0x0000000000000000000000000000000000000000000000000000000000000000 scratch space"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x40  0x0000000000000000000000000000000000000000000000000000000000000100 free memory pointer (increased by 128)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x60  0x0000000000000000000000000000000000000000000000000000000000000000 zero slot"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x80  0x000000000000000000000000000000000000000000000000000000000000004E old string length (78), no longer used"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xA0  0x0000000000000000000000000000000000000000000000000000000000000000 unused but reserved memory"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xC0  0x0000000000000000000000000000000000000000000000000000000000000000 partially the string length"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xE0  0x0000000000000000000000000131000000000000000000000000000000000000 string length (1) and the single char"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x100 0xfff"})})]})}),(0,n.jsxs)(s.p,{children:["Loading 32 bytes to obtain the string's length at the str pointer will work correctly: ",(0,n.jsx)(s.code,{children:"0x0000000000000000000000000000000000000000000000000000000000000001"})]}),(0,n.jsxs)(s.p,{children:["But loading 32 bytes to obtain the actual string's contents at ",(0,n.jsx)(s.code,{children:"add(str, 32)"})," will partially return data not belonging to the string: ",(0,n.jsx)(s.code,{children:"0x31000000000000000000000000000000000000ffffffffffffffffffffffffff"})]}),(0,n.jsx)(s.p,{children:"To prevent this, the expression should allocate another 32 bytes, therefore a sum of 160 bytes instead of 128."}),(0,n.jsx)(s.p,{children:"C: Removing the expression would cause later allocations of memory to use the space where the string has been stored, causing it to be overwritten."}),(0,n.jsxs)(s.p,{children:["D: This expression, as well as the rest of the inline ",(0,n.jsx)(s.code,{children:"assembly"})," block, is memory-safe as already covered by the previous question."]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-3-of-8",children:"Question 3 of 8"}),"\n",(0,n.jsx)(s.p,{children:"Select all true statements:"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The expression ",(0,n.jsx)(s.code,{children:"mstore(str, k)"})," at the beginning can be removed to save gas"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. The expression ",(0,n.jsx)(s.code,{children:"mstore(add(str, k), char)"})," can be replaced by an equivalent ",(0,n.jsx)(s.code,{children:"mstore8(...)"})," to simplify the code."]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. The final expression ",(0,n.jsx)(s.code,{children:"mstore(str, sub(78, k))"})," can be removed to save gas"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. The function does not return the correct output for ",(0,n.jsx)(s.code,{children:"n = 2**256 - 1"})]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is A, B."})}),(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"A: The expression storing the string's length at the beginning can indeed be removed to save gas as it's supposed to be overwritten by the actual string's length at the function's end."}),"\n",(0,n.jsxs)(s.li,{children:["B: As explained in one of the previous answers, ",(0,n.jsx)(s.code,{children:"MSTORE"})," always writes 32 bytes, which is quite unnecessary (as we're only writing one byte each round) and makes the algorithm more complicated to understand. Using ",(0,n.jsx)(s.code,{children:"MSTORE8"})," this could be significantly simplified as it would only touch a single byte in memory, just as needed by this algorithm."]}),"\n",(0,n.jsx)(s.li,{children:"C: The expression storing the final string's length shouldn't be removed as the string would end up having a length of 0 according to the str pointer pointing at the 32 zero-bytes before the actual string value starts."}),"\n",(0,n.jsx)(s.li,{children:"D: The function actually does return the correct output for the maximum uint256 integer value."}),"\n"]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-4-of-8",children:"Question 4 of 8"}),"\n",(0,n.jsx)(s.p,{children:"Select all true statements:"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The function correctly cleans all necessary memory regions"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Solidity will correctly be able to handle the string returned by the function"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. The last bits of memory in the string may be dirty"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. None of the above"]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is B, C."})}),(0,n.jsxs)(s.p,{children:["A: The function does not properly clean all the memory regions that it accesses, this allows dirty bits to remain. Remember that using memory that is still marked \"free\" according to the free-memory-pointer doesn't guarantee that it hasn't been used as a temporary memory by previous operations. Based on the previous ",(0,n.jsx)(s.code,{children:"toString(1)"}),' example, here\'s how the memory would look like if all of the "free" bytes have been set to 0xff before the function was called:']}),(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x00 0x0000000000000000000000000000000000000000000000000000000000000000 scratch space"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x20 0x0000000000000000000000000000000000000000000000000000000000000000 scratch space"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x40 0x0000000000000000000000000000000000000000000000000000000000000100 free memory pointer (increased by 128)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x60 0x0000000000000000000000000000000000000000000000000000000000000000 zero slot"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0x80 0x000000000000000000000000000000000000000000000000000000000000004E old string length (78), no longer used"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xA0 0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff unused but reserved memory"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xC0 0xffffffffffffffffffffffffff00000000000000000000000000000000000000 partially the string length"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xE0 0x0000000000000000000000000131ffffffffffffffffffffffffffffffffffff string length (1) and the single char"})})]})}),(0,n.jsx)(s.p,{children:"B: Despite all of the function's imperfections, it'll still be able to appear to be working perfectly fine outside of assembly thanks to Solidity's cleanup measures."}),(0,n.jsx)(s.p,{children:"C: This once again references the issue of insufficient memory being allocated (See Q2) causing later memory allocations to overlap with the end of the string."})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(o.UW,{type:"info",children:(0,n.jsx)(s.p,{children:"The last four questions are based on the below abstract contract:"})}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-line-numbers":"","data-language":"plaintext","data-theme":"default","data-line-numbers-max-digits":"2",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'import "@openzeppelin/contracts/security/ReentrancyGuard.sol";'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"abstract contract Proxy is ReentrancyGuard {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function _delegate(address implementation) nonReentrant internal virtual {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'        assembly ("memory-safe") {'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // Copy msg.data. We take full control of memory in this inline assembly"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // block because it will not return to Solidity code. We overwrite the"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // Solidity scratch pad at memory position 0."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            calldatacopy(0, 0, calldatasize())"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // Call the implementation."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // out and outsize are 0 because we don't know the size yet."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            let result := delegatecall(gas(), implementation, 0, calldatasize(), 0, 0)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // Copy the returned data."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            returndatacopy(0, 0, returndatasize())"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            switch result"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            // delegatecall returns 0 on error."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            case 0 {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                revert(0, returndatasize())"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            default {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                return(0, returndatasize())"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-5-of-8",children:"Question 5 of 8"}),"\n",(0,n.jsx)(s.p,{children:"Select all true statements:"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The re-entrancy lock is always unnecessary as it’s never possible to re-enter the contract"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Calls to ",(0,n.jsx)(s.code,{children:"_delegate"})," are correctly protected for re-entrancy."]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. The re-entrancy lock is correctly unlocked in some cases"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. The re-entrancy lock is correctly unlocked in all cases"]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is C."})}),(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"A: This is an abstract contract, meaning it'll need be inherited by another which may have more functions, functions that may allow reentering. Furthermore, the implementation contract's functions are unknown as well and they too may allow to re-enter. Based on the available information it's not possible to come to the conclusion that it's \"never possible to re-enter\"."}),"\n",(0,n.jsx)(s.li,{children:'B: The fact that it\'s "protecting" against reentrancy is more of an happy accident of the bug. It\'ll prevent reentrancy in practice, but it\'ll also deadlock the contract forever. With that being the case it cannot be said that calls to the delegation function are "correctly protected".'}),"\n",(0,n.jsxs)(s.li,{children:["C/D: The function will always either ",(0,n.jsx)(s.code,{children:"revert"})," or ",(0,n.jsx)(s.code,{children:"return"}),". Returning within assembly is a bit different than returning in Solidity: The ",(0,n.jsx)(s.code,{children:"RETURN"})," opcode will end the current EVM execution context immediately and return the specified data to the external caller. This means that the code in ",(0,n.jsx)(s.code,{children:"nonReentrant"})," responsible for unlocking is practically unreachable, leaving the contract in a deadlock state. It may still seemingly correctly unlock if the implementation contract's storage variables re-use the same storage slot and unlock it from there. In the reverting case the code responsible for unlocking will be skipped, as intended, and instead the contract is unlocked by the fact that all changes done to the contract's state are reverted."]}),"\n"]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-6-of-8",children:"Question 6 of 8"}),"\n",(0,n.jsx)(s.p,{children:"Select all true statements:"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The assembly block is correctly marked as ",(0,n.jsx)(s.code,{children:"‘memory-safe’"})]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. The assembly block will always violate the memory requirements needed for ",(0,n.jsx)(s.code,{children:"memory-safe"})," blocks"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. In some cases, the assembly block will not violate the requirement needed for ",(0,n.jsx)(s.code,{children:"memory-safe"})," blocks"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. None of the above"]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is C."})}),(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:['A: The assembly block is purposely not memory-safe (it takes "full control of memory") and the reason it gives for it in the first inline comment is that this is not an issue as "it will not return to Solidity code". Meaning that it can do whatever it wants as this EVM context will end after its execution. But that isn\'t actually true anymore due to the usage of the ',(0,n.jsx)(s.code,{children:"nonReentrant"})," modifier. Such an inconsistency would be a big hint that something smells here during a secure code review."]}),"\n",(0,n.jsxs)(s.li,{children:["B/C: It won't violate the memory requirements as long as the ",(0,n.jsx)(s.code,{children:"calldata"})," and the ",(0,n.jsx)(s.code,{children:"returndata"})," is empty or fits into the memory's scratch space."]}),"\n"]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-7-of-8",children:"Question 7 of 8"}),"\n",(0,n.jsx)(s.p,{children:"Select all true statements:"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The expression ",(0,n.jsx)(s.code,{children:"calldatacopy(0, 0, calldatasize())"})," violates ",(0,n.jsx)(s.code,{children:"memory-safe"})," assembly annotation"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. The expression ",(0,n.jsx)(s.code,{children:"returndatacopy(0, 0, returndatasize())"})," violates ",(0,n.jsx)(s.code,{children:"memory-safe"})," assembly annotation"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. The expression ",(0,n.jsx)(s.code,{children:"delegatecall(gas(), implementation, 0, calldatasize(), 0, 0)"})," violates ",(0,n.jsx)(s.code,{children:"memory-safe"})," assembly annotation"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. The expression ",(0,n.jsx)(s.code,{children:"return(0, returndatasize())"})," violates ",(0,n.jsx)(s.code,{children:"memory-safe"})," assembly annotation"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," E. The expression ",(0,n.jsx)(s.code,{children:"revert(0, returndatasize())"})," violates ",(0,n.jsx)(s.code,{children:"memory-safe"})," assembly annotation"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," F. None of the above."]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is A, B."})}),(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["A: Copies ",(0,n.jsx)(s.code,{children:"calldata"})," into memory starting in the scratch space. If ",(0,n.jsx)(s.code,{children:"calldata"})," doesn't fit it'll violate memory-safety."]}),"\n",(0,n.jsx)(s.li,{children:"B: Does the same, but with the data returned from the external delegate-call."}),"\n",(0,n.jsx)(s.li,{children:"C: The delegate-call operation only reads from memory and the actual execution happens within a fresh EVM context. No violations can happen here."}),"\n",(0,n.jsx)(s.li,{children:"D/E: Both operations only read from memory and immediately end the current EVM execution context."}),"\n"]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-8-of-8",children:"Question 8 of 8"}),"\n",(0,n.jsx)(s.p,{children:"Select all true statements:"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. ",(0,n.jsx)(s.code,{children:"delegatecall"})," can never re-enter as the state is shared"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. ",(0,n.jsx)(s.code,{children:"delegatecall"})," proxies without proper access controls may be prone to ",(0,n.jsx)(s.code,{children:"selfdestruct"})]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Proxies are typically used to save deploy-time gas costs"]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Proxies can be used to prevent contract size limit issues"]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is B, C, D."})}),(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"A: Nonsensical filler option."}),"\n",(0,n.jsx)(s.li,{children:"B: It's true that delegate-call operations are very dangerous, especially if an attacker is able to get control over the destination address which could be a self-destructing contract."}),"\n",(0,n.jsx)(s.li,{children:"C: Extremely small proxies, usually referred to as clones, can be used to deploy code only once and re-use it over and over again."}),"\n",(0,n.jsx)(s.li,{children:"D: Proxies may delegate to multiple implementations allowing the code size limit to be bypassed."}),"\n"]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n","\n",(0,n.jsxs)(o.oy,{children:[(0,n.jsx)(o.Zb,{icon:(0,n.jsx)(x.H8,{}),title:"← Secureum A-MAZE-X CTF 2023 At DeFi Security Summit",href:"/posts/2023/7/16/secureum-a-maze-x-ctf-2023-at-defi-security-summit/"}),(0,n.jsx)(o.Zb,{icon:(0,n.jsx)(x.H8,{}),title:"← Go-To: RACE #19 Of The Secureum Bootcamp Epoch∞",href:"/posts/2023/7/3/race-19-of-the-secureum-bootcamp-epoch-infinity/"}),(0,n.jsx)(o.Zb,{icon:(0,n.jsx)(x.H8,{}),title:"RACE #21 Of The Secureum Bootcamp Epoch∞ →",href:"/posts/2023/9/5/race-21-of-the-secureum-bootcamp-epoch-infinity"})]})]})}s.default=(0,a.j)({MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,l.a)(),e.components);return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/posts/2023/7/30/race-20-of-the-secureum-bootcamp-epoch-infinity.mdx",route:"/posts/2023/7/30/race-20-of-the-secureum-bootcamp-epoch-infinity",timestamp:1731290394e3,title:"RACE #20 Of The Secureum Bootcamp Epoch∞",headings:p},pageNextRoute:"/posts/2023/7/30/race-20-of-the-secureum-bootcamp-epoch-infinity"})},96139:function(e,s,t){var n=t(94869);t(26228);var i=t(70079),r=i&&"object"==typeof i&&"default"in i?i:{default:i};function _defineProperties(e,s){for(var t=0;t<s.length;t++){var n=s[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=void 0!==n&&n.env&&!0,isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function StyleSheet(e){var s=void 0===e?{}:e,t=s.name,n=void 0===t?"stylesheet":t,i=s.optimizeForSpeed,r=void 0===i?a:i;invariant$1(isString(n),"`name` must be a string"),this._name=n,this._deletedRulePlaceholder="#"+n+"-deleted-rule____{}",invariant$1("boolean"==typeof r,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=r,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l=document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var e,s=StyleSheet.prototype;return s.setOptimizeForSpeed=function(e){invariant$1("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),invariant$1(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},s.isOptimizeForSpeed=function(){return this._optimizeForSpeed},s.inject=function(){var e=this;if(invariant$1(!this._injected,"sheet already injected"),this._injected=!0,this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(a||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(s,t){return"number"==typeof t?e._serverSheet.cssRules[t]={cssText:s}:e._serverSheet.cssRules.push({cssText:s}),t},deleteRule:function(s){e._serverSheet.cssRules[s]=null}}},s.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].ownerNode===e)return document.styleSheets[s]},s.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},s.insertRule=function(e,s){if(invariant$1(isString(e),"`insertRule` accepts only strings"),this._optimizeForSpeed){var t=this.getSheet();"number"!=typeof s&&(s=t.cssRules.length);try{t.insertRule(e,s)}catch(s){return a||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var n=this._tags[s];this._tags.push(this.makeStyleTag(this._name,e,n))}return this._rulesCount++},s.replaceRule=function(e,s){if(this._optimizeForSpeed){var t=this.getSheet();if(s.trim()||(s=this._deletedRulePlaceholder),!t.cssRules[e])return e;t.deleteRule(e);try{t.insertRule(s,e)}catch(n){a||console.warn("StyleSheet: illegal rule: \n\n"+s+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),t.insertRule(this._deletedRulePlaceholder,e)}}else{var n=this._tags[e];invariant$1(n,"old rule at index `"+e+"` not found"),n.textContent=s}return e},s.deleteRule=function(e){if(this._optimizeForSpeed)this.replaceRule(e,"");else{var s=this._tags[e];invariant$1(s,"rule at index `"+e+"` not found"),s.parentNode.removeChild(s),this._tags[e]=null}},s.flush=function(){this._injected=!1,this._rulesCount=0,this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]},s.cssRules=function(){var e=this;return this._tags.reduce(function(s,t){return t?s=s.concat(Array.prototype.map.call(e.getSheetForTag(t).cssRules,function(s){return s.cssText===e._deletedRulePlaceholder?null:s})):s.push(null),s},[])},s.makeStyleTag=function(e,s,t){s&&invariant$1(isString(s),"makeStyleTag accepts only strings as second parameter");var n=document.createElement("style");this._nonce&&n.setAttribute("nonce",this._nonce),n.type="text/css",n.setAttribute("data-"+e,""),s&&n.appendChild(document.createTextNode(s));var i=document.head||document.getElementsByTagName("head")[0];return t?i.insertBefore(n,t):i.appendChild(n),n},_defineProperties(StyleSheet.prototype,[{key:"length",get:function(){return this._rulesCount}}]),e&&_defineProperties(StyleSheet,e),StyleSheet}();function invariant$1(e,s){if(!e)throw Error("StyleSheet: "+s+".")}var stringHash=function(e){for(var s=5381,t=e.length;t;)s=33*s^e.charCodeAt(--t);return s>>>0},o={};function computeId(e,s){if(!s)return"jsx-"+e;var t=String(s),n=e+t;return o[n]||(o[n]="jsx-"+stringHash(e+"-"+t)),o[n]}function computeSelector(e,s){var t=e+s;return o[t]||(o[t]=s.replace(/__jsx-style-dynamic-selector/g,e)),o[t]}var c=function(){function StyleSheetRegistry(e){var s=void 0===e?{}:e,t=s.styleSheet,n=void 0===t?null:t,i=s.optimizeForSpeed,r=void 0!==i&&i;this._sheet=n||new l({name:"styled-jsx",optimizeForSpeed:r}),this._sheet.inject(),n&&"boolean"==typeof r&&(this._sheet.setOptimizeForSpeed(r),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var e=StyleSheetRegistry.prototype;return e.add=function(e){var s=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,s){return e[s]=0,e},{}));var t=this.getIdAndRules(e),n=t.styleId,i=t.rules;if(n in this._instancesCounts){this._instancesCounts[n]+=1;return}var r=i.map(function(e){return s._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[n]=r,this._instancesCounts[n]=1},e.remove=function(e){var s=this,t=this.getIdAndRules(e).styleId;if(function(e,s){if(!e)throw Error("StyleSheetRegistry: "+s+".")}(t in this._instancesCounts,"styleId: `"+t+"` not found"),this._instancesCounts[t]-=1,this._instancesCounts[t]<1){var n=this._fromServer&&this._fromServer[t];n?(n.parentNode.removeChild(n),delete this._fromServer[t]):(this._indices[t].forEach(function(e){return s._sheet.deleteRule(e)}),delete this._indices[t]),delete this._instancesCounts[t]}},e.update=function(e,s){this.add(s),this.remove(e)},e.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},e.cssRules=function(){var e=this,s=this._fromServer?Object.keys(this._fromServer).map(function(s){return[s,e._fromServer[s]]}):[],t=this._sheet.cssRules();return s.concat(Object.keys(this._indices).map(function(s){return[s,e._indices[s].map(function(e){return t[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},e.styles=function(e){var s,t;return s=this.cssRules(),void 0===(t=e)&&(t={}),s.map(function(e){var s=e[0],n=e[1];return r.default.createElement("style",{id:"__"+s,key:"__"+s,nonce:t.nonce?t.nonce:void 0,dangerouslySetInnerHTML:{__html:n}})})},e.getIdAndRules=function(e){var s=e.children,t=e.dynamic,n=e.id;if(t){var i=computeId(n,t);return{styleId:i,rules:Array.isArray(s)?s.map(function(e){return computeSelector(i,e)}):[computeSelector(i,s)]}}return{styleId:computeId(n),rules:Array.isArray(s)?s:[s]}},e.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,s){return e[s.id.slice(2)]=s,e},{})},StyleSheetRegistry}(),h=i.createContext(null);h.displayName="StyleSheetContext";var d=r.default.useInsertionEffect||r.default.useLayoutEffect,x=new c;function JSXStyle(e){var s=x||i.useContext(h);return s&&d(function(){return s.add(e),function(){s.remove(e)}},[e.id,String(e.dynamic)]),null}JSXStyle.dynamic=function(e){return e.map(function(e){return computeId(e[0],e[1])}).join(" ")},s.style=JSXStyle},65910:function(e,s,t){"use strict";e.exports=t(96139).style},26228:function(){}},function(e){e.O(0,[3220,1589,9774,2888,179],function(){return e(e.s=60319)}),_N_E=e.O()}]);