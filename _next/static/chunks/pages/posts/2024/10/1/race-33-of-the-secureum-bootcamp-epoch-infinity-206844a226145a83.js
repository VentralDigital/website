(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3489],{11821:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/2024/10/1/race-33-of-the-secureum-bootcamp-epoch-infinity",function(){return n(90092)}])},64751:function(e,s){"use strict";s.Z={src:"/_next/static/media/secureum-banner.b3ad8557.jpg",height:630,width:1200,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCAAEAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAbEAACAgMBAAAAAAAAAAAAAAAAAgEDBCEyE//EABUBAQEAAAAAAAAAAAAAAAAAAAQF/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAECEf/aAAwDAQACEQMRAD8AnGFcviyPjUWS1PTJuOtgAcT9auj/2Q==",blurWidth:8,blurHeight:4}},90092:function(e,s,n){"use strict";n.r(s),n.d(s,{HiddenSolution:function(){return HiddenSolution},__toc:function(){return x}});var t=n(35250),i=n(65910),r=n.n(i),a=n(47147),c=n(77298),l=n(18363),o=n(30746),h=n.n(o),d=n(64751),p=n(13423);function HiddenSolution(e){let{children:s}=e,n=Object.assign({details:"details",summary:"summary",strong:"strong",div:"div"},(0,c.a)());return(0,t.jsxs)(n.details,{closed:!0,className:"last-of-type:mb-0 rounded-lg bg-neutral-50 dark:bg-neutral-800 p-2 mt-4",children:[(0,t.jsx)(n.summary,{children:(0,t.jsx)(n.strong,{className:"text-lg",children:"Solution"})}),(0,t.jsx)(n.div,{className:"nx-p-2",children:s})]})}let x=[{depth:3,value:"Code",id:"code"},{depth:3,value:"Question 1 of 8",id:"question-1-of-8"},{depth:3,value:"Question 2 of 8",id:"question-2-of-8"},{depth:3,value:"Question 3 of 8",id:"question-3-of-8"},{depth:3,value:"Question 4 of 8",id:"question-4-of-8"},{depth:3,value:"Question 5 of 8",id:"question-5-of-8"},{depth:3,value:"Question 6 of 8",id:"question-6-of-8"},{depth:3,value:"Question 7 of 8",id:"question-7-of-8"},{depth:3,value:"Question 8 of 8",id:"question-8-of-8"}];function _createMdxContent(e){let s=Object.assign({h1:"h1",p:"p",a:"a",strong:"strong",hr:"hr",h3:"h3",code:"code",pre:"pre",span:"span"},(0,c.a)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{children:"RACE #33 Of The Secureum Bootcamp Epoch∞"}),"\n","\n",(0,t.jsxs)(h(),{children:[(0,t.jsx)("meta",{property:"og:image",content:"https://ventral.digital"+d.Z.src,className:"jsx-ea2c409626c7be76"}),(0,t.jsx)("meta",{name:"twitter:image",content:"https://ventral.digital"+d.Z.src,className:"jsx-ea2c409626c7be76"})]}),"\n",(0,t.jsxs)(s.p,{children:["This is a Write-Up of RACE-33, Quiz of the ",(0,t.jsx)(s.a,{href:"https://twitter.com/0xRajeev/status/1470910752085065731",children:"Secureum Bootcamp"})," for Ethereum Smart Contract Auditors. This month's RACE was designed by Secureum Mentor ",(0,t.jsx)(s.a,{href:"https://x.com/sick_nerdballer",children:"George"})," from ",(0,t.jsx)(s.a,{href:"https://x.com/ConsenSysAudits",children:"Consensys Diligence"}),"."]}),"\n",(0,t.jsxs)(l.UW,{type:"info",children:[(0,t.jsxs)(s.p,{children:["Participants of this quiz had to ",(0,t.jsx)(s.strong,{children:"answer 8 questions within the strict time limit of 16 minutes"}),". If you’re reading this in preparation for participating yourself, it’s best to give it a try under the same time limit!"]}),(0,t.jsx)(s.p,{children:"As usual, I waited for submissions to close before publishing it and, to stay true to the original, I omitted syntax highlighting. Feel free to copy it into your favorite editor, but do so after starting the timer!"})]}),"\n",(0,t.jsxs)("p",{className:"jsx-ea2c409626c7be76 text-xs text-right",children:["October 1, 2024 by ",(0,t.jsx)(s.a,{href:"/about#patrickd",children:"patrickd"})]}),"\n",(0,t.jsx)(r(),{id:"ea2c409626c7be76",children:"input[type=checkbox].jsx-ea2c409626c7be76{width:15px;height:15px}li.jsx-ea2c409626c7be76{padding:.5em}"}),"\n","\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"code",children:"Code"}),"\n",(0,t.jsxs)(l.UW,{type:"info",children:[(0,t.jsx)(s.p,{children:"All 8 questions are based on the following contract for a custom token implementation."}),(0,t.jsxs)(s.p,{children:["At first, the contract mints the intended token total supply (",(0,t.jsx)(s.code,{children:"totalSupplyCap"}),") to the 0-address. Then, the owner transfers those tokens from the 0-address to the signatory addresses in batches as they see fit. Those addresses create signatures that allow users to claim some amounts of tokens. In order to claim those tokens, users need to deposit some ETH into the contract, which will be subtracted from them based on the amount of tokens they are claiming with the signature from signatories. Finally, users will be able to withdraw their deposited ETH after requesting withdrawals with a locking period."]}),(0,t.jsxs)(s.p,{children:["For simplicity, assume that the contract was deployed with ",(0,t.jsx)(s.code,{children:"totalSupplyCap=10**6"}),", and 5 users have already deposited ETH in anticipation of their claims, to a total of 10 ETH."]}),(0,t.jsxs)(s.p,{children:["The ERC20 implementation used (",(0,t.jsx)(s.code,{children:"ERC20_modified.sol"}),") is a modified version of OpenZeppelin's implementation where 0-address checks have been removed which didn't allow transfers to/from the 0-address without minting/burning respectively. Assume the rest of the functionality, like appropriate modification of ",(0,t.jsx)(s.code,{children:"_totalSupply"})," tracking, has been adjusted as well."]})]}),"\n",(0,t.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",filename:"PrivilegedMintToken.sol",children:(0,t.jsxs)(s.code,{"data-line-numbers":"","data-language":"plaintext","data-theme":"default","data-line-numbers-max-digits":"3",children:[(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// SPDX-License-Identifier: MIT"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"pragma solidity ^0.8.0;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'import "contracts/ERC20_modified.sol";'})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'import "@openzeppelin/contracts/access/Ownable.sol";'})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'import "@openzeppelin/contracts/utils/structs/EnumerableSet.sol";'})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"contract PrivilegedMintToken is ERC20, Ownable {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    using EnumerableSet for EnumerableSet.AddressSet;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    uint256 public immutable totalSupplyCap;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    uint256 public mintedSupply;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    uint256 public tokensPerEthPrice;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    EnumerableSet.AddressSet private privilegedAddresses;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    mapping(address => uint256) public deposits;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    mapping(address => uint256) public withdrawals;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    mapping(address => uint256) public unlockedAt;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    event BalanceUpdated(address indexed user, uint256 newBalance);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    event Minted(address indexed recipient, uint256 amount);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    event Deposit(address indexed user, uint256 amount);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    event Withdrawal(address indexed user, uint256 amount);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'    constructor(uint256 _totalSupplyCap) ERC20("PrivilegedMintToken", "PMT") Ownable(msg.sender) payable {'})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        totalSupplyCap = _totalSupplyCap;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        mintedSupply = 0;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        tokensPerEthPrice = 10**4;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        mintToSigner(address(0), _totalSupplyCap);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function setTokenPrice(uint256 _price) external onlyOwner {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        tokensPerEthPrice = _price;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function mintToSigner(address recipient, uint256 amount) public onlyOwner {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        if (recipient == address(0)) {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            _mint(recipient, amount);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        } else {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            _transfer(address(0), recipient, amount);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            mintedSupply += amount;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        privilegedAddresses.add(recipient);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        emit Minted(recipient, amount);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function getUserMintAmount(uint256 amount, address user) public view returns (uint256) {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        uint256 requiredDeposit = amount / tokensPerEthPrice;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        if (deposits[user] >= requiredDeposit) {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            return amount;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        } else {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            return 0;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function userClaim(address recipient, uint256 amount, bytes32 sigR, bytes32 sigS, uint8 sigV) external {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        bytes32 messageHash = keccak256(abi.encodePacked(recipient, amount));"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       "})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        bytes32 ethSignedMessageHash = keccak256("})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            abi.encodePacked("})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'                "\\x19Ethereum Signed Message:\\n32",'})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                messageHash"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            )"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        );"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        address recoveredSigner = ecrecover(ethSignedMessageHash, sigV, sigR, sigS);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'        require(privilegedAddresses.contains(recoveredSigner), "Invalid signature");'})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        uint256 mintAmount = getUserMintAmount(amount, recipient);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'        require(mintAmount > 0, "Insufficient deposit to mint");'})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        _transfer(recoveredSigner, msg.sender, amount);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        deposits[msg.sender] -= amount / tokensPerEthPrice;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        emit BalanceUpdated(msg.sender, deposits[msg.sender]);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        emit Minted(recipient, mintAmount);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function deposit() external payable {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        deposits[msg.sender] += msg.value;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        unlockedAt[msg.sender] = block.timestamp + 1 days;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        emit Deposit(msg.sender, msg.value);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   "})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function prepareWithdrawal(uint256 amount) external {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'        require(deposits[msg.sender] >= amount, "Insufficient deposit");'})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        withdrawals[msg.sender] += amount;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        unlockedAt[msg.sender] = block.timestamp + 1 days;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        deposits[msg.sender] -= amount;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        emit BalanceUpdated(msg.sender, amount);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function withdraw(uint256 amount) external {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        if (unlockedAt[msg.sender] < block.timestamp) {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            emit Withdrawal(msg.sender, deposits[msg.sender]);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        else {"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            revert();"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        withdrawals[msg.sender] = 0;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        unlockedAt[msg.sender] = 0;"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        payable(msg.sender).transfer(amount);"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,t.jsx)(s.span,{className:"line",children:(0,t.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,t.jsx)(s.h3,{id:"question-1-of-8",children:"Question 1 of 8"}),"\n",(0,t.jsx)(s.p,{children:"The signature used to claim tokens by user:"}),"\n",(0,t.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Is secure because it uses ",(0,t.jsx)(s.code,{children:"ecrecover"})," directly by itself. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Is secure from cross-chain attacks because it uses the wrapper ",(0,t.jsx)(s.code,{children:'"\\x19Ethereum Signed Message:\\n32"'}),". "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Can be re-used. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Is using an outdated hashing mechanism ",(0,t.jsx)(s.code,{children:"keccak256"})," that is not compatible with ",(0,t.jsx)(s.code,{children:"ecrecover"})," after the Paris hardfork. "]})]}),"\n",(0,t.jsxs)(HiddenSolution,{children:[(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Correct is C."})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"A"}),": Arguably the opposite is true, there are some intricacies that should be considered when making use of the ",(0,t.jsxs)(s.a,{href:"https://www.evm.codes/precompiled?fork=cancun#0x01",children:[(0,t.jsx)(s.code,{children:"ecrecover()"})," precompile"]}),". It's recommended to make use of a library such as ",(0,t.jsx)(s.a,{href:"https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol",children:"OpenZeppelin's ECDSA"})," contract which takes care of them. Also consider the ",(0,t.jsx)(s.a,{href:"https://github.com/Uniswap/permit2/blob/main/src/libraries/SignatureVerification.sol",children:"SignatureVerification"})," contract of Permit2, which offers a more condensed handling."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"B"}),": This wrapper alone offers no protection against cross-chain attacks between Ethereum-based chains. Furthermore, the contract does not make use of ",(0,t.jsx)(s.a,{href:"https://eips.ethereum.org/EIPS/eip-712",children:"EIP712"})," for structuring the signed data, allowing replay attacks due to a lack of chain ID, target address, etc, especially with such a simple (recipient, amount) pair being signed."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"C"}),": Not only can the signature be re-played in other places, the same signature can also be re-used multiple times within this contract as it lacks any checks of a nonce, or any other type of logic that would mark a signature as having been redeemed."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"D"}),": The ",(0,t.jsx)(s.code,{children:"keccak256"})," function is the generally recommended hashing mechanism within Ethereum, and there's no compatibility issue using it with ",(0,t.jsx)(s.code,{children:"ecrecover"}),"."]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"question-2-of-8",children:"Question 2 of 8"}),"\n",(0,t.jsx)(s.p,{children:"The signer address recovery process:"}),"\n",(0,t.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Will always retrieve the correct signer of the message. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Can retrieve a 0-address as the recovered signer address. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Can retrieve a random/uncontrolled address as the recovered signer address. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Is missing a parameter ",(0,t.jsx)(s.code,{children:"z"})," from the signature to retrieve the signer address. "]})]}),"\n",(0,t.jsxs)(HiddenSolution,{children:[(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Correct is B, C."})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"B"}),": If the signature is mathematically incorrect preventing any public key, and from that, address to be recovered, the ",(0,t.jsx)(s.code,{children:"ecrecover()"})," function does not revert. Instead it simply returns the 0-address. Instead of handling that as an error it continues on as if the 0-address itself is the legitimate signer. This 0-address contains all of the initial supply and is also part of the privileged addresses."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"A/C"}),": It is however possible to construct a signature that can be processed (the math works) but returns arbitrary and unpredictable addresses as the supposed signer. Looking at the ",(0,t.jsx)(s.a,{href:"/posts/2023/8/22/applied-elliptic-curve-cryptography/#ecdsa",children:"Applied Elliptic Curve Cryptography"})," article on ECDSA you can see that nothing is stopping your from choosing random private keys for creating a signature."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"D"}),": There's no ",(0,t.jsx)(s.code,{children:"z"})," parameter for ",(0,t.jsx)(s.a,{href:"https://www.evm.codes/precompiled?fork=cancun#0x01",children:(0,t.jsx)(s.code,{children:"ecrecover"})}),"."]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"question-3-of-8",children:"Question 3 of 8"}),"\n",(0,t.jsxs)(s.p,{children:["The users that claim the tokens via ",(0,t.jsx)(s.code,{children:"userClaim"}),":"]}),"\n",(0,t.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Are always part of the signature. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Can have their signature transactions front-run. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Need to deposit before claiming 1000 tokens. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Can control how many tokens they claim in one transaction. "]})]}),"\n",(0,t.jsxs)(HiddenSolution,{children:[(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Correct is B."})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"A"}),": The receiver of the tokens (",(0,t.jsx)(s.code,{children:"msg.sender"}),") may be different from the address ",(0,t.jsx)(s.code,{children:"receiver"})," specified which is part of the signature. Meaning that the user who is making the claim is not necessarily part of the signature."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"B"}),": An adversary could indeed monitor the transaction memory pool for calls to ",(0,t.jsx)(s.code,{children:"userClaim"})," and front-run these using that same signature."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"C"}),": Claiming 1000 tokens does not actually require a deposit as it will be rounded down to 0. This is due to truncation from integer division at ",(0,t.jsx)(s.code,{children:"requiredDeposit = amount / tokensPerEthPrice"})," with ",(0,t.jsx)(s.code,{children:"tokensPerEthPrice = 10**4"}),"."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"D"}),": The claim amount cannot be directly controlled as it is part of the signature."]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"question-4-of-8",children:"Question 4 of 8"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"getUserMintAmount()"})," function:"]}),"\n",(0,t.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Takes in ETH amount and recipient address as arguments, returns PMT token amount to be minted. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Takes in PMT token amount and recipient address as arguments, returns ETH amount to be subtracted from the user balance. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Takes in PMT token amount and recipient address as arguments, returns PMT token amount to be minted. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Is correctly performing the required deposit calculation that isn’t vulnerable to any rounding issues as it uses a pre-calculated price provided via ",(0,t.jsx)(s.code,{children:"tokensPerEthPrice"}),". "]})]}),"\n",(0,t.jsxs)(HiddenSolution,{children:[(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Correct is C."})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"A"}),": The required amount of ETH is computed within this function, and the deposited amount of ETH is read from storage. It does not take in the ETH amount as argument."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"B"}),": It does not return an ETH amount to be subtracted, it returns the amount of PMT token to be transferred, if the deposited amount of ETH is sufficient."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"C"}),": Yes."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"D"}),": It is vulnerable to rounding errors when small amounts (",(0,t.jsx)(s.code,{children:"amount < tokensPerEthPrice"}),") are passed."]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"question-5-of-8",children:"Question 5 of 8"}),"\n",(0,t.jsx)(s.p,{children:"In the deposit and withdrawal process:"}),"\n",(0,t.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Users can only withdraw as much as they deposit. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. The withdrawal process has a re-entrancy issue that can exploit the contract as the transfer occurs before the state update. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Users need to perform a deposit, then request withdrawal, and only then can receive any funds from the contract. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. None of the above. "]})]}),"\n",(0,t.jsxs)(HiddenSolution,{children:[(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Correct is D."})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"A/C"}),": Because the ",(0,t.jsx)(s.code,{children:"unlockedAt"})," timestamp is zero-initialized for users that have never made a deposit, they can simply call ",(0,t.jsx)(s.code,{children:"withdraw()"})," directly without previously calling ",(0,t.jsx)(s.code,{children:"prepareWithdraw()"}),", allowing them to obtain arbitrary amounts because it will satisfy ",(0,t.jsx)(s.code,{children:"unlockedAt[msg.sender] < block.timestamp"}),". This is works because the ",(0,t.jsx)(s.code,{children:"withdrawals"})," amount is re-set to 0 instead of subtracting the amount being withdrawn from it, which would cause a revert from integer underflow protection if a user attempted to withdraw more than deposited."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"B"}),": No, the external call (via ",(0,t.jsx)(s.code,{children:"transfer()"}),") is made at the end of the function when state updates have already happened (Checks-Effects-Interactions pattern followed)."]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"question-6-of-8",children:"Question 6 of 8"}),"\n",(0,t.jsx)(s.p,{children:"The events are:"}),"\n",(0,t.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Correctly emitted for all ",(0,t.jsx)(s.code,{children:"Deposit"})," events. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Correctly emitted for all ",(0,t.jsx)(s.code,{children:"Withdrawal"})," events. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Correctly emitted for all ",(0,t.jsx)(s.code,{children:"BalanceUpdated"})," events. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Correctly emitted for all ",(0,t.jsx)(s.code,{children:"Minted"})," events. "]})]}),"\n",(0,t.jsx)(HiddenSolution,{children:(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Correct is A."})})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"question-7-of-8",children:"Question 7 of 8"}),"\n",(0,t.jsx)(s.p,{children:"Assuming there are no vulnerabilities, the owner:"}),"\n",(0,t.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Cannot mint more tokens than is defined by variable ",(0,t.jsx)(s.code,{children:"totalSupplyCap"}),". "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Receives all spent deposits to their owner address directly. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Can change the price of the token. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Can retrieve any user funds from the contract. "]})]}),"\n",(0,t.jsxs)(HiddenSolution,{children:[(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Correct is C."})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"A"}),": Owner can mint past ",(0,t.jsx)(s.code,{children:"_totalSupplyCap"})," by executing ",(0,t.jsx)(s.code,{children:"mintToSigner"})," to 0-address again."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"B"}),": The owner address is only used for authentication purposes, never receives deposits directly."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"C"}),": Yes, via the ",(0,t.jsx)(s.code,{children:"setTokenPrice()"})," function."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"D"}),": With the assumption that the vulnerability within ",(0,t.jsx)(s.code,{children:"withdraw()"})," has been fixed, no."]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h3,{id:"question-8-of-8",children:"Question 8 of 8"}),"\n",(0,t.jsx)(s.p,{children:"The contract:"}),"\n",(0,t.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Is ERC-20 compliant. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Is upgradeable. "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. No longer complies with the ERC-20 standard due to changed function names like ",(0,t.jsx)(s.code,{children:"mintToSigner"})," and ",(0,t.jsx)(s.code,{children:"userClaim"})," instead of mint.  "]}),(0,t.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,t.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Is not EIP-712 compliant. "]})]}),"\n",(0,t.jsxs)(HiddenSolution,{children:[(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Correct is A, D."})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"A/C"}),": Despite using a modified OpenZeppelin ERC-20 implementation, the contract is still ERC-20 compliant."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"B"}),": Does not make use of any patterns allowing to upgrade the contract's logic."]}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"D"}),": See solution to ",(0,t.jsx)(s.strong,{children:"Question 1"}),"."]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n","\n",(0,t.jsxs)(l.oy,{children:[(0,t.jsx)(l.Zb,{icon:(0,t.jsx)(p.H8,{}),title:"← RACE #32 Of The Secureum Bootcamp Epoch∞",href:"/posts/2024/9/8/race-32-of-the-secureum-bootcamp-epoch-infinity/"}),(0,t.jsx)(l.Zb,{icon:(0,t.jsx)(p.H8,{}),title:"RACE #34 Of The Secureum Bootcamp Epoch∞ →",href:"/posts/2024/11/10/race-34-of-the-secureum-bootcamp-epoch-infinity"})]})]})}s.default=(0,a.j)({MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,c.a)(),e.components);return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/posts/2024/10/1/race-33-of-the-secureum-bootcamp-epoch-infinity.mdx",route:"/posts/2024/10/1/race-33-of-the-secureum-bootcamp-epoch-infinity",timestamp:1731343268e3,title:"RACE #33 Of The Secureum Bootcamp Epoch∞",headings:x},pageNextRoute:"/posts/2024/10/1/race-33-of-the-secureum-bootcamp-epoch-infinity"})},96139:function(e,s,n){var t=n(94869);n(26228);var i=n(70079),r=i&&"object"==typeof i&&"default"in i?i:{default:i};function _defineProperties(e,s){for(var n=0;n<s.length;n++){var t=s[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}var a=void 0!==t&&t.env&&!0,isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},c=function(){function StyleSheet(e){var s=void 0===e?{}:e,n=s.name,t=void 0===n?"stylesheet":n,i=s.optimizeForSpeed,r=void 0===i?a:i;invariant$1(isString(t),"`name` must be a string"),this._name=t,this._deletedRulePlaceholder="#"+t+"-deleted-rule____{}",invariant$1("boolean"==typeof r,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=r,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var c=document.querySelector('meta[property="csp-nonce"]');this._nonce=c?c.getAttribute("content"):null}var e,s=StyleSheet.prototype;return s.setOptimizeForSpeed=function(e){invariant$1("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),invariant$1(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},s.isOptimizeForSpeed=function(){return this._optimizeForSpeed},s.inject=function(){var e=this;if(invariant$1(!this._injected,"sheet already injected"),this._injected=!0,this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(a||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(s,n){return"number"==typeof n?e._serverSheet.cssRules[n]={cssText:s}:e._serverSheet.cssRules.push({cssText:s}),n},deleteRule:function(s){e._serverSheet.cssRules[s]=null}}},s.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].ownerNode===e)return document.styleSheets[s]},s.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},s.insertRule=function(e,s){if(invariant$1(isString(e),"`insertRule` accepts only strings"),this._optimizeForSpeed){var n=this.getSheet();"number"!=typeof s&&(s=n.cssRules.length);try{n.insertRule(e,s)}catch(s){return a||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var t=this._tags[s];this._tags.push(this.makeStyleTag(this._name,e,t))}return this._rulesCount++},s.replaceRule=function(e,s){if(this._optimizeForSpeed){var n=this.getSheet();if(s.trim()||(s=this._deletedRulePlaceholder),!n.cssRules[e])return e;n.deleteRule(e);try{n.insertRule(s,e)}catch(t){a||console.warn("StyleSheet: illegal rule: \n\n"+s+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),n.insertRule(this._deletedRulePlaceholder,e)}}else{var t=this._tags[e];invariant$1(t,"old rule at index `"+e+"` not found"),t.textContent=s}return e},s.deleteRule=function(e){if(this._optimizeForSpeed)this.replaceRule(e,"");else{var s=this._tags[e];invariant$1(s,"rule at index `"+e+"` not found"),s.parentNode.removeChild(s),this._tags[e]=null}},s.flush=function(){this._injected=!1,this._rulesCount=0,this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]},s.cssRules=function(){var e=this;return this._tags.reduce(function(s,n){return n?s=s.concat(Array.prototype.map.call(e.getSheetForTag(n).cssRules,function(s){return s.cssText===e._deletedRulePlaceholder?null:s})):s.push(null),s},[])},s.makeStyleTag=function(e,s,n){s&&invariant$1(isString(s),"makeStyleTag accepts only strings as second parameter");var t=document.createElement("style");this._nonce&&t.setAttribute("nonce",this._nonce),t.type="text/css",t.setAttribute("data-"+e,""),s&&t.appendChild(document.createTextNode(s));var i=document.head||document.getElementsByTagName("head")[0];return n?i.insertBefore(t,n):i.appendChild(t),t},_defineProperties(StyleSheet.prototype,[{key:"length",get:function(){return this._rulesCount}}]),e&&_defineProperties(StyleSheet,e),StyleSheet}();function invariant$1(e,s){if(!e)throw Error("StyleSheet: "+s+".")}var stringHash=function(e){for(var s=5381,n=e.length;n;)s=33*s^e.charCodeAt(--n);return s>>>0},l={};function computeId(e,s){if(!s)return"jsx-"+e;var n=String(s),t=e+n;return l[t]||(l[t]="jsx-"+stringHash(e+"-"+n)),l[t]}function computeSelector(e,s){var n=e+s;return l[n]||(l[n]=s.replace(/__jsx-style-dynamic-selector/g,e)),l[n]}var o=function(){function StyleSheetRegistry(e){var s=void 0===e?{}:e,n=s.styleSheet,t=void 0===n?null:n,i=s.optimizeForSpeed,r=void 0!==i&&i;this._sheet=t||new c({name:"styled-jsx",optimizeForSpeed:r}),this._sheet.inject(),t&&"boolean"==typeof r&&(this._sheet.setOptimizeForSpeed(r),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var e=StyleSheetRegistry.prototype;return e.add=function(e){var s=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,s){return e[s]=0,e},{}));var n=this.getIdAndRules(e),t=n.styleId,i=n.rules;if(t in this._instancesCounts){this._instancesCounts[t]+=1;return}var r=i.map(function(e){return s._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[t]=r,this._instancesCounts[t]=1},e.remove=function(e){var s=this,n=this.getIdAndRules(e).styleId;if(function(e,s){if(!e)throw Error("StyleSheetRegistry: "+s+".")}(n in this._instancesCounts,"styleId: `"+n+"` not found"),this._instancesCounts[n]-=1,this._instancesCounts[n]<1){var t=this._fromServer&&this._fromServer[n];t?(t.parentNode.removeChild(t),delete this._fromServer[n]):(this._indices[n].forEach(function(e){return s._sheet.deleteRule(e)}),delete this._indices[n]),delete this._instancesCounts[n]}},e.update=function(e,s){this.add(s),this.remove(e)},e.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},e.cssRules=function(){var e=this,s=this._fromServer?Object.keys(this._fromServer).map(function(s){return[s,e._fromServer[s]]}):[],n=this._sheet.cssRules();return s.concat(Object.keys(this._indices).map(function(s){return[s,e._indices[s].map(function(e){return n[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},e.styles=function(e){var s,n;return s=this.cssRules(),void 0===(n=e)&&(n={}),s.map(function(e){var s=e[0],t=e[1];return r.default.createElement("style",{id:"__"+s,key:"__"+s,nonce:n.nonce?n.nonce:void 0,dangerouslySetInnerHTML:{__html:t}})})},e.getIdAndRules=function(e){var s=e.children,n=e.dynamic,t=e.id;if(n){var i=computeId(t,n);return{styleId:i,rules:Array.isArray(s)?s.map(function(e){return computeSelector(i,e)}):[computeSelector(i,s)]}}return{styleId:computeId(t),rules:Array.isArray(s)?s:[s]}},e.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,s){return e[s.id.slice(2)]=s,e},{})},StyleSheetRegistry}(),h=i.createContext(null);h.displayName="StyleSheetContext";var d=r.default.useInsertionEffect||r.default.useLayoutEffect,p=new o;function JSXStyle(e){var s=p||i.useContext(h);return s&&d(function(){return s.add(e),function(){s.remove(e)}},[e.id,String(e.dynamic)]),null}JSXStyle.dynamic=function(e){return e.map(function(e){return computeId(e[0],e[1])}).join(" ")},s.style=JSXStyle},65910:function(e,s,n){"use strict";e.exports=n(96139).style},26228:function(){}},function(e){e.O(0,[3220,1589,9774,2888,179],function(){return e(e.s=11821)}),_N_E=e.O()}]);