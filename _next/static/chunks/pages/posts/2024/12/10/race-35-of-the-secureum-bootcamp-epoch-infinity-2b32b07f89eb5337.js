(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6144],{69440:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/2024/12/10/race-35-of-the-secureum-bootcamp-epoch-infinity",function(){return t(96267)}])},64751:function(e,s){"use strict";s.Z={src:"/_next/static/media/secureum-banner.b3ad8557.jpg",height:630,width:1200,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCAAEAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAbEAACAgMBAAAAAAAAAAAAAAAAAgEDBCEyE//EABUBAQEAAAAAAAAAAAAAAAAAAAQF/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAECEf/aAAwDAQACEQMRAD8AnGFcviyPjUWS1PTJuOtgAcT9auj/2Q==",blurWidth:8,blurHeight:4}},96267:function(e,s,t){"use strict";t.r(s),t.d(s,{HiddenSolution:function(){return HiddenSolution},__toc:function(){return p}});var n=t(35250),i=t(65910),a=t.n(i),r=t(47147),c=t(77298),l=t(18363),o=t(30746),h=t.n(o),d=t(64751),x=t(13423);function HiddenSolution(e){let{children:s}=e,t=Object.assign({details:"details",summary:"summary",strong:"strong",div:"div"},(0,c.a)());return(0,n.jsxs)(t.details,{closed:!0,className:"last-of-type:mb-0 rounded-lg bg-neutral-50 dark:bg-neutral-800 p-2 mt-4",children:[(0,n.jsx)(t.summary,{children:(0,n.jsx)(t.strong,{className:"text-lg",children:"Solution"})}),(0,n.jsx)(t.div,{className:"nx-p-2",children:s})]})}let p=[{depth:3,value:"Question 1 of 8",id:"question-1-of-8"},{depth:3,value:"Question 2 of 8",id:"question-2-of-8"},{depth:3,value:"Question 3 of 8",id:"question-3-of-8"},{depth:3,value:"Question 4 of 8",id:"question-4-of-8"},{depth:3,value:"Question 5 of 8",id:"question-5-of-8"},{depth:3,value:"Question 6 of 8",id:"question-6-of-8"},{depth:3,value:"Question 7 of 8",id:"question-7-of-8"},{depth:3,value:"Question 8 of 8",id:"question-8-of-8"}];function _createMdxContent(e){let s=Object.assign({h1:"h1",p:"p",a:"a",strong:"strong",hr:"hr",h3:"h3",pre:"pre",code:"code",span:"span",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td"},(0,c.a)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{children:"RACE #35 Of The Secureum Bootcamp Epoch∞"}),"\n","\n",(0,n.jsxs)(h(),{children:[(0,n.jsx)("meta",{property:"og:image",content:"https://ventral.digital"+d.Z.src,className:"jsx-ea2c409626c7be76"}),(0,n.jsx)("meta",{name:"twitter:image",content:"https://ventral.digital"+d.Z.src,className:"jsx-ea2c409626c7be76"})]}),"\n",(0,n.jsxs)(s.p,{children:["This is a Write-Up of RACE-35, Quiz of the ",(0,n.jsx)(s.a,{href:"https://twitter.com/0xRajeev/status/1470910752085065731",children:"Secureum Bootcamp"})," for Ethereum Smart Contract Auditors. This month's RACE was designed by Secureum Mentor and Independent Security Researcher 0x4non aka ",(0,n.jsx)(s.a,{href:"https://x.com/eugenioclrc",children:"another anon"}),"."]}),"\n",(0,n.jsxs)(l.UW,{type:"info",children:[(0,n.jsxs)(s.p,{children:["Participants of this quiz had a single attempt to ",(0,n.jsx)(s.strong,{children:"answer 8 questions within the strict time limit of 16 minutes"}),". If you’re reading this in preparation for participating yourself, it’s best to give it a try under the same time limit!"]}),(0,n.jsx)(s.p,{children:"As usual, I waited for submissions to close before publishing it and, to stay true to the original, I omitted syntax highlighting. Feel free to copy it into your favorite editor, but do so after starting the timer!"})]}),"\n",(0,n.jsxs)("p",{className:"jsx-ea2c409626c7be76 text-xs text-right",children:["December 10, 2024 by ",(0,n.jsx)(s.a,{href:"/about#patrickd",children:"patrickd"})]}),"\n",(0,n.jsx)(a(),{id:"ea2c409626c7be76",children:"input[type=checkbox].jsx-ea2c409626c7be76{width:15px;height:15px}li.jsx-ea2c409626c7be76{padding:.5em}"}),"\n","\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-1-of-8",children:"Question 1 of 8"}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-line-numbers":"","data-language":"plaintext","data-theme":"default","data-line-numbers-max-digits":"1",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// this is the contract that its in your generated address"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"contract Empty{}"})})]})}),"\n",(0,n.jsx)(s.p,{children:"You have received a bug bounty in USDC and, as usual, you generate a new wallet to receive it. After the project has paid, you use etherscan to check if the funds arrived. But you discover that your wallet is a contract! What are the odds? Which of the following statements are true?"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. You can directly transfer the USDC using your private key. "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. You can’t send a tx because of EIP-3607. "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. It is still possible to recover the USDC. "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. The USDC is lost forever. "]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is B, C."})}),(0,n.jsx)(s.p,{children:"In the rare event that this happens, A is not possible because of B."}),(0,n.jsx)(s.p,{children:"EIP-3607 was specifically created to handle this type of situation where a contract address and an EOA address have a collision: To prevent a situation where it turns out that an otherwise trustworthy contract address suddenly rug pulls all funds using such a collision, this Ethereum Improvement Proposal was implemented dictating that any private-key based transactions from addresses with code must be rejected by nodes and not included or accepted in blocks."}),(0,n.jsxs)(s.p,{children:["EIP-3607 warns that it can be bypassed by a blockchain reorganization or by self-destructing the contract. The former should be rather unlikely, the latter won't work anymore either with the changes to the ",(0,n.jsx)(s.code,{children:"SELFDESTRUCT"})," opcode introduced by the Dencun (Cancun-Deneb, March 2024) Fork where deleting the contract code is only possible if it was deployed within that same transaction. But in the first place, this empty contract doesn't allow to trigger self-destruction."]}),(0,n.jsxs)(s.p,{children:["However there's still a way to rescue the funds: After all, they aren't actually located at that address, rather it's that the token contract has stored a balance for that address. As long as we have an approval to the funds of that address without actually sending transactions from it, we can rescue them using a ",(0,n.jsx)(s.code,{children:"transferFrom()"})," call. Naturally, a call to ",(0,n.jsx)(s.code,{children:"approve()"})," would be rejected by EIP-3607 just as a call to ",(0,n.jsx)(s.code,{children:"transfer()"})," would. But luckily USDC implements ",(0,n.jsx)(s.code,{children:"permit()"})," (EIP-2612) which allows us to sign an approval to the funds without an on-chain transaction."]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-2-of-8",children:"Question 2 of 8"}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-line-numbers":"","data-language":"plaintext","data-theme":"default","data-line-numbers-max-digits":"1",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"function docall(address vault, string memory func, bytes calldata data) external {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'  require(keccak256(bytes(func)) != keccak256("withdraw()"), "forbidden sig");'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  (bool success, ) = address(vault).call(abi.encodeWithSignature(func, data));"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  require(success);"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["Which of the following statements are true regarding the ",(0,n.jsx)(s.code,{children:"docall()"})," function?"]}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Function is secure, an user can not bypass the check and call ",(0,n.jsx)(s.code,{children:"withdraw()"}),". "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Function is not secure, an user can bypass the check and call ",(0,n.jsx)(s.code,{children:"withdraw()"}),". "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Function needs a reentrancy guard. "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Function will always revert. "]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is B."})}),(0,n.jsxs)(s.p,{children:["A/B: What's actually used in a call is only the first 4 bytes of the function signature's hash. This check requires the full hash to be unequal, which makes this check trivial to bypass: We can have the first 4 bytes that actually matter match with the first 4 bytes of ",(0,n.jsx)(s.code,{children:'keccak256("withdraw()")'})," and the rest of the hash can just be random as long as its different. Such function-signature clashes, ie. functions that share the first 4 bytes of the keccak256 hash are easily generated. Specifying ",(0,n.jsx)(s.code,{children:"hack_540276142()"})," as ",(0,n.jsx)(s.code,{children:"func"})," will do the trick here. Check out the ",(0,n.jsx)(s.a,{href:"https://rekt.news/polynetwork-rekt/",children:"Polynetwork hack"})," for a real-world example of a function-signature clash being exploited."]}),(0,n.jsx)(s.p,{children:"C: This function has no state changes. Reentrancy vulnerabilities are related to passing execution control to other (often untrusted) code while the contract's state has not been fully updated yet, allowing that other code to exploit such incomplete state."}),(0,n.jsx)(s.p,{children:"D: It will revert depending on whether the call can be executed successfully. But it won't always revert."})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-3-of-8",children:"Question 3 of 8"}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-line-numbers":"","data-language":"plaintext","data-theme":"default","data-line-numbers-max-digits":"2",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"/// @dev docall is a secure function that lets you call an address with any message except “withdraw()”"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"function docall(address vault, bytes calldata data) external {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    bytes4 sig;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    assembly {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        sig := calldataload(0x64)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'    // abi.encodeWithSignature("withdraw()") == 0x3ccfd60b'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'    require(sig != 0x3ccfd60b, "forbidden sig");'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    (bool success, ) = address(vault).call(data);"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    require(success);"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsxs)(s.p,{children:["Which of the following statements are true regarding the ",(0,n.jsx)(s.code,{children:"docall()"})," function?"]}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Function is secure, the check cannot be bypassed. "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. This can be easily bypassed by calling ",(0,n.jsx)(s.code,{children:'docall(vault, abi.encodeWithSignature("withdraw()", "anything"));'}),". "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Function is not secure, a user can bypass the check and call ",(0,n.jsx)(s.code,{children:"withdraw()"}),". "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. This function is protected by EIP-3607. "]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is C."})}),(0,n.jsxs)(s.p,{children:["Here an attacker can exploit the fact that ABI encoding makes use of pointers for variable length types like bytes. We can put any rubbish at offset ",(0,n.jsx)(s.code,{children:"0x64"})," if the actual content of the ",(0,n.jsx)(s.code,{children:"data"})," variable is specified to be located somewhere else."]}),(0,n.jsx)(s.p,{children:"The contract expects the calldata to have the following structure:"}),(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Offset"}),(0,n.jsx)(s.th,{children:"Length in bytes"}),(0,n.jsx)(s.th,{children:"Description"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"0x00"})}),(0,n.jsx)(s.td,{children:"4"}),(0,n.jsxs)(s.td,{children:["function signature of ",(0,n.jsx)(s.code,{children:"docall(address,bytes)"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"0x04"})}),(0,n.jsx)(s.td,{children:"32"}),(0,n.jsxs)(s.td,{children:["20 bytes of these are occupied by the ",(0,n.jsx)(s.code,{children:"vault"})," address"]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"0x24"})}),(0,n.jsx)(s.td,{children:"32"}),(0,n.jsxs)(s.td,{children:["pointer specifying the offset where the content of ",(0,n.jsx)(s.code,{children:"data"})," is located, excludes the function signature, ie. points to ",(0,n.jsx)(s.code,{children:"0x44"})," by specifying ",(0,n.jsx)(s.code,{children:"0x40"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"0x44"})}),(0,n.jsx)(s.td,{children:"32"}),(0,n.jsxs)(s.td,{children:["length of the raw value of ",(0,n.jsx)(s.code,{children:"data"})]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"0x64"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"0x44"})}),(0,n.jsxs)(s.td,{children:["actual raw value of ",(0,n.jsx)(s.code,{children:"data"}),", the first 32 bytes of this are loaded by ",(0,n.jsx)(s.code,{children:"sig := calldataload(0x64)"})]})]})]})]}),(0,n.jsxs)(s.p,{children:["To exploit this, the above calldata can be rewritten to have the pointer specify a later location, such as ",(0,n.jsx)(s.code,{children:"0x80"})," the value at which will be decoded and put into the ",(0,n.jsx)(s.code,{children:"data"})," variable. But the value loaded into the ",(0,n.jsx)(s.code,{children:"sig"})," variable will instead be whatever we put at ",(0,n.jsx)(s.code,{children:"0x64"}),", which we can choose freely."]}),(0,n.jsx)(s.p,{children:"Answers B and C are fillers."})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-4-of-8",children:"Question 4 of 8"}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-line-numbers":"","data-language":"plaintext","data-theme":"default","data-line-numbers-max-digits":"2",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"contract Token {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    Owner immutable public owner;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    constructor(address _owner) {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        owner = Owner(_owner);"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    ......."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"contract Owner {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    Token immutable public token;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    constructor(address _token) {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        token = Token(_token);"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    ......."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsx)(s.p,{children:"Which of the following statements are true for the above contracts?"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. This setup is impossible to deploy. "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Can be deployed using a contract that uses ",(0,n.jsx)(s.code,{children:"CREATE"}),". "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Can be deployed using the ",(0,n.jsx)(s.code,{children:"CREATE2"})," opcode with the above contracts' bytecode. "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Can be deployed using a contract that uses the ",(0,n.jsx)(s.code,{children:"CREATE3"})," pattern. "]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is B, D."})}),(0,n.jsxs)(s.p,{children:["The apparent problem here is that there's a circular dependency between these contracts where ",(0,n.jsx)(s.code,{children:"Token"})," requires the address of ",(0,n.jsx)(s.code,{children:"Owner"})," before it can be deployed, while ",(0,n.jsx)(s.code,{children:"Owner"})," requires the address of ",(0,n.jsx)(s.code,{children:"Token"})," to be deployed. But addresses of contracts can be deterministically determined before they're actually created on-chain."]}),(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsx)(s.code,{"data-language":"text","data-theme":"default",children:(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"NEXT_CREATE_ADDRESS = HASH(deployer_address, deployer_nonce)"})})})}),(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"CREATE"})," opcode determines a contract's address based on the address of the contract executing the ",(0,n.jsx)(s.code,{children:"CREATE"})," opcode, hashed with that contract's ",(0,n.jsx)(s.code,{children:"nonce"})," counter. Both of these values can be known beforehand, therefore we're able to determine the deployment address without actually deploying anything yet."]}),(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsx)(s.code,{"data-language":"text","data-theme":"default",children:(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"NEXT_CREATE2_ADDRESS = HASH(0xff, deployer_address, salt, init_code)"})})})}),(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"CREATE2"})," opcode is different in that, instead of a ",(0,n.jsx)(s.code,{children:"nonce"}),", it determines the deployment address based on a ",(0,n.jsx)(s.code,{children:"salt"})," that we can freely choose and on the initialization code of the contract to deploy."]}),(0,n.jsxs)(s.p,{children:["You may think that the problem here is the use of ",(0,n.jsx)(s.code,{children:"immutable"})," variables, the values of which are placed into the bytecode by the constructor, therefore changing the deployment address. This is not the case though, as the constructor is causing changes to the runtime bytecode when placing the values of immutables, not the initialization bytecode that is actually used to determine the deployment address."]}),(0,n.jsxs)(s.p,{children:["The actual problem is that the ",(0,n.jsx)(s.code,{children:"address"})," passed into the constructor is part of the initialization bytecode, throwing us back to the circular dependency problem. The initialization bytecode basically consists of 3 components: The actual initialization code (ie. constructor and storage variable assignments), the raw runtime bytecode (with empty placeholders for immutable variables ready to be filled by initialization code), and finally the ABI-encoded parameter values to be passed to the constructor."]}),(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"PROXY_DEPLOYER_ADDRESS = HASH(0xff, deployer_address, salt, PROXY_DEPLOYER_BYTECODE)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"NEXT_CREATE3_ADDRESS = HASH(PROXY_DEPLOYER_ADDRESS, FIRST_PROXY_DEPLOYER_NONCE)"})})]})}),(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"CREATE3"})," pattern is not an actual opcode, but rather ",(0,n.jsx)(s.a,{href:"https://github.com/0xsequence/create3/blob/master/contracts/Create3.sol",children:"a trick"})," that allows removing the initialization code as a factor for the deployment address. It works by deploying a simple static contract via ",(0,n.jsx)(s.code,{children:"CREATE2"})," that does nothing else but deploy whatever you send to it as calldata via ",(0,n.jsx)(s.code,{children:"CREATE"}),'. Thanks to this "proxy deployer" always having the same initialization bytecode, we can pre-determine its address deterministically. We can hash this address with a nonce of 1 to determine the deployment address of whatever code we will pass to it.']})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(l.UW,{type:"info",children:(0,n.jsx)(s.p,{children:"The remaining questions of this RACE are based on the following code."})}),"\n",(0,n.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-line-numbers":"","data-language":"plaintext","data-theme":"default","data-line-numbers-max-digits":"2",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"pragma solidity ^0.8.24;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'import "@openzeppelin/contracts/proxy/ERC1967/ERC1967Proxy.sol";'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'import "@openzeppelin/contracts-upgradeable/proxy/utils/Initializable.sol";'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// deploy example:"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// new ProxyContract(address(new ImplementationContract()));"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"contract ProxyContract is ERC1967Proxy {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    uint160 public counter;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    uint public cState;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    address public admin;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    constructor(address logic) ERC1967Proxy(logic, abi.encodeWithSelector(ImplementationContract.initialize.selector)) {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        ERC1967Utils.changeAdmin(msg.sender);"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        admin = msg.sender;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    receive() external payable {}"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function implementation() external view returns (address) {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        return _implementation();"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function upgradeTo(address newImplementation) external {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'        require(ERC1967Utils.getAdmin() == msg.sender, "NoT AdMiN");'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'        ERC1967Utils.upgradeToAndCall(newImplementation,"");'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function updateCounter(uint160 _counter) external {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        counter = _counter;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function updatecState(uint newState) external {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        cState = newState;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// Hint, slots of arrays are keccak256(abi.encode(SLOT_NUMBER)) "})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// https://www.rareskills.io/post/solidity-dynamic"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"contract ImplementationContract is Initializable{"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    address public owner;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    uint private constant MAX = 10;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    uint256[] public buckets;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'    /// @dev Equivalent to: `uint72(bytes9(keccak256("_REENTRANCY_GUARD_SLOT")))`'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    uint256 constant private _REENTRANCY_GUARD = 0x929eee149b4bd21268;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    modifier reentrantGuard() {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        assembly { "})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            let _reenter := tload(_REENTRANCY_GUARD)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            if eq(_reenter, 2) {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                mstore(0x00, 0xab143c06) // `Reentrancy()`."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"                revert(0x1c, 0x04)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"            tstore(_REENTRANCY_GUARD, 2)"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        _;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    constructor() {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        owner = msg.sender;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function initialize() external {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        buckets = new uint256[](MAX);"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        buckets[0] = 1;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function deposit(uint bucketNumber, uint value) payable external {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(msg.sender==owner);"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        unchecked { buckets[bucketNumber] += value; }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    function withdraw(uint bucketNumber, uint value) external reentrantGuard {"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        require(msg.sender==owner);"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        unchecked {buckets[bucketNumber] -= value;}"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'        msg.sender.call{value: value}("");'})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsx)(s.h3,{id:"question-5-of-8",children:"Question 5 of 8"}),"\n",(0,n.jsx)(s.p,{children:"In one tx anyone can change:"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The admin slot of the ",(0,n.jsx)(s.code,{children:"ProxyContract"})," by calling ",(0,n.jsx)(s.code,{children:"updatecState()"}),". "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. The implementation of the ",(0,n.jsx)(s.code,{children:"ProxyContract"})," by calling ",(0,n.jsx)(s.code,{children:"updatecState()"}),". "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. The owner of the ",(0,n.jsx)(s.code,{children:"ImplementationContract"})," by calling ",(0,n.jsx)(s.code,{children:"updateCounter()"}),". "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. The implementation of the ",(0,n.jsx)(s.code,{children:"ProxyContract"})," by calling ",(0,n.jsx)(s.code,{children:"updateCounter()"}),". "]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is C."})}),(0,n.jsxs)(s.p,{children:["C/D: There is a storage clash between the ",(0,n.jsx)(s.code,{children:"ProxyContract"}),"'s ",(0,n.jsx)(s.code,{children:"counter"})," variable and the ",(0,n.jsx)(s.code,{children:"ImplementationContract"}),"'s ",(0,n.jsx)(s.code,{children:"owner"})," variable: Due to the way how Solidity manages storage variables, both variables will be assigned to the same storage slots. Since a proxy shares the same storage with its implementation(s) that means that setting one overwrites the other. Calling ",(0,n.jsx)(s.code,{children:"updateCounter()"})," will cause a change in these clashing variables, but none to the proxy's implementation storage variable."]}),(0,n.jsxs)(s.p,{children:["A/B: Calling ",(0,n.jsx)(s.code,{children:"updatecState()"})," will update the value at slot 1, which for the implementation contains the length of the ",(0,n.jsx)(s.code,{children:"buckets"})," array, and for the proxy contains the value of ",(0,n.jsx)(s.code,{children:"cState"}),". At no point does this affect the admin slot or implementation of the proxy."]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-6-of-8",children:"Question 6 of 8"}),"\n",(0,n.jsx)(s.p,{children:"Which of the following statements are true?"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. It is possible to reinitialize the implementation and ",(0,n.jsx)(s.code,{children:"selfdestruct"})," triggering a DOS."]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. It is possible to add more than 10 elements to the bucket."]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. It’s impossible to add more than 10 elements to the bucket."]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. By default ",(0,n.jsx)(s.code,{children:"ImplementationContract(proxy).owner()"})," is the ",(0,n.jsx)(s.code,{children:"msg.sender"}),"."]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is B."})}),(0,n.jsxs)(s.p,{children:["As mentioned in the previous question, due to the storage clash between ",(0,n.jsx)(s.code,{children:"cState"})," and the length of the ",(0,n.jsx)(s.code,{children:"buckets"})," array, it's possible to increase the array length and therefore add more than 10 elements to the bucket."]}),(0,n.jsxs)(s.p,{children:["The initial value of ",(0,n.jsx)(s.code,{children:"ImplementationContract(proxy).owner()"})," will be the zero-address because the owner is set within the ",(0,n.jsx)(s.code,{children:"constructor"}),", instead of the ",(0,n.jsx)(s.code,{children:"initialize()"})," function."]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-7-of-8",children:"Question 7 of 8"}),"\n",(0,n.jsx)(s.p,{children:"It is possible to:"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Change the ",(0,n.jsx)(s.code,{children:"ERC1967Proxy.ADMIN_SLOT"})," value. "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Change the proxy ",(0,n.jsx)(s.code,{children:"IMPLEMENTATION"})," without calling ",(0,n.jsx)(s.code,{children:"upgradeTo(address newImplementation)"}),". "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Renounce the ",(0,n.jsx)(s.code,{children:"ERC1967Proxy"}),", making it impossible to regain ownership and without changing the current implementation. "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Change the value of slot ",(0,n.jsx)(s.code,{children:"_REENTRANCY_GUARD"})," to trigger a DOS in ",(0,n.jsx)(s.code,{children:"withdraw(uint256,uint256)"}),". "]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is A [and B]."})}),(0,n.jsxs)(s.p,{children:["We can find the following storage slot locations in OpenZeppelin's ",(0,n.jsx)(s.a,{href:"https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/proxy/ERC1967/ERC1967Utils.sol",children:"ERC1967Utils.sol"}),":"]}),(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"ADMIN_SLOT = 0xb53127684a568b3173ae13b9f8a6016e243e63b6e8ee1178d6a717850b5d6103;"})})]})}),(0,n.jsxs)(s.p,{children:["As mentioned within the code's inline comments, we can also determine the slot location of the first array element based on the Solidity-assigned slot number of the array variable (here 1) with ",(0,n.jsx)(s.code,{children:"keccak256(abi.encode(SLOT_NUMBER))"}),":"]}),(0,n.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"> FIRST_ARRAY_ITEM_SLOT = keccak256(abi.encode(1))"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"0xb10e2d527612073b26eecdfd717e6a320cf44b4afac2b0732d9fcbe2b7fa0cf6"})})]})}),(0,n.jsxs)(s.p,{children:["With this we can see that the order of these slots within storage is ",(0,n.jsx)(s.code,{children:"IMPLEMENTATION_SLOT"}),", ",(0,n.jsx)(s.code,{children:"FIRST_ARRAY_ITEM_SLOT"}),", ",(0,n.jsx)(s.code,{children:"ADMIN_SLOT"})," which means that we can keep adding elements to the ",(0,n.jsx)(s.code,{children:"buckets"})," array until we clash with the ",(0,n.jsx)(s.code,{children:"ADMIN_SLOT"})," and are able to overwrite it."]}),(0,n.jsx)(s.p,{children:"This vulnerability also makes it impossible to fully renounce ownership, as you could always exploit it to regain ownership."}),(0,n.jsx)(s.p,{children:"The reentrancy guard is making use of transient storage, which always starts with zeroed values at the beginning of a transaction. A Denial of Service would require using the persistent storage instead."}),(0,n.jsx)(s.hr,{}),(0,n.jsxs)(s.p,{children:["As ",(0,n.jsx)(s.a,{href:"https://x.com/_YaNnhui_",children:"Y4nhu1"})," pointed out on ",(0,n.jsx)(s.a,{href:"https://discord.com/channels/814328279468474419/928508513964146729/1317729509071654923",children:"Discord"}),", it's actually also possible to update the proxy's implementation by exploiting the same issue, and therefore without calling the ",(0,n.jsx)(s.code,{children:"upgradeTo()"})," function."]}),(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.a,{href:"https://soliditylang.org/blog/2020/12/16/solidity-v0.8.0-release-announcement/",children:"Solidity version 0.8.0"})," added overflow protection against arrays growing too large in memory. The assumption was that this too prevents arrays in storage from becoming so large that they would wrap-around and allow manipulating storage slots before the first array element. But this is not the case."]}),(0,n.jsxs)(s.p,{children:["Using the ",(0,n.jsx)(s.code,{children:"updatecState()"})," function we can set the ",(0,n.jsx)(s.code,{children:"buckets"})," array length to the maximum value of the ",(0,n.jsx)(s.code,{children:"uint256"})," type. This effectively means that the array's contents cover the entirety of the storage. With ",(0,n.jsx)(s.code,{children:".deposit()"})," we are then able to specify the storage slot we want to overwrite as ",(0,n.jsx)(s.code,{children:"bucketNumber"}),", ie. the index of the bucket that the ",(0,n.jsx)(s.code,{children:"value"})," will be added to."]}),(0,n.jsx)(s.pre,{"data-language":"solidity","data-theme":"default",children:(0,n.jsxs)(s.code,{"data-language":"solidity","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Update the owner using the storage clash with the counter variable (See Q5)."})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"proxy."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"updateCounter"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"uint160"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"address"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")));"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Make the buckets array stretch over the contract's entire storage."})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"proxy."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"updatecState"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(type("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"uint"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:").max);"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Compute the index within the buckets array at which IMPLEMENTATION_SLOT is located."})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"uint"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" bucketNumber "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" type("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"uint"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:").max "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"uint"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"keccak256"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(abi."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"encode"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"))) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"+"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" IMPLEMENTATION_SLOT;"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// Update the value at IMPLEMENTATION_SLOT."})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"impl."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"deposit"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(bucketNumber"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"0x1337"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:");"})]})]})})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"question-8-of-8",children:"Question 8 of 8"}),"\n",(0,n.jsx)(s.p,{children:"Which of the following statements are true?"}),"\n",(0,n.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. ",(0,n.jsx)(s.code,{children:"reentrantGuard"})," modifier cannot be bypassed. "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. ",(0,n.jsx)(s.code,{children:"withdraw"})," will get locked forever after calling it one time. "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. The ",(0,n.jsx)(s.code,{children:"reentrantGuard"})," with transient storage is more gas efficient. "]}),(0,n.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,n.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. All the above. "]})]}),"\n",(0,n.jsxs)(HiddenSolution,{children:[(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Correct is A, C."})}),(0,n.jsxs)(s.p,{children:["A: Although the ",(0,n.jsx)(s.code,{children:"reentrantGuard"})," modifier can indeed not be bypassed, it also never actually unlocks itself. This means that functions using the modifier can't be called twice within the same transaction."]}),(0,n.jsx)(s.p,{children:"B: While this is not true on the actual chain, it will appear like that when testing it within Foundry which runs everything within a single transaction without clearing the TRANSIENT storage between tests."}),(0,n.jsx)(s.p,{children:"C: Modifying a transient storage value is indeed cheaper than modifying persistent storage (ie. the global state)."})]}),"\n",(0,n.jsx)(s.hr,{}),"\n","\n",(0,n.jsxs)(l.oy,{children:[(0,n.jsx)(l.Zb,{icon:(0,n.jsx)(x.H8,{}),title:"← RACE #34 Of The Secureum Bootcamp Epoch∞",href:"/posts/2024/11/10/race-34-of-the-secureum-bootcamp-epoch-infinity/"}),(0,n.jsx)(l.Zb,{icon:(0,n.jsx)(x.H8,{}),title:"RACE #36 Of The Secureum Bootcamp Epoch∞ →",href:"/posts/2025/1/10/race-36-of-the-secureum-bootcamp-epoch-infinity/"})]})]})}s.default=(0,r.j)({MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,c.a)(),e.components);return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/posts/2024/12/10/race-35-of-the-secureum-bootcamp-epoch-infinity.mdx",route:"/posts/2024/12/10/race-35-of-the-secureum-bootcamp-epoch-infinity",timestamp:1736535047e3,title:"RACE #35 Of The Secureum Bootcamp Epoch∞",headings:p},pageNextRoute:"/posts/2024/12/10/race-35-of-the-secureum-bootcamp-epoch-infinity"})},96139:function(e,s,t){var n=t(94869);t(26228);var i=t(70079),a=i&&"object"==typeof i&&"default"in i?i:{default:i};function _defineProperties(e,s){for(var t=0;t<s.length;t++){var n=s[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=void 0!==n&&n.env&&!0,isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},c=function(){function StyleSheet(e){var s=void 0===e?{}:e,t=s.name,n=void 0===t?"stylesheet":t,i=s.optimizeForSpeed,a=void 0===i?r:i;invariant$1(isString(n),"`name` must be a string"),this._name=n,this._deletedRulePlaceholder="#"+n+"-deleted-rule____{}",invariant$1("boolean"==typeof a,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=a,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var c=document.querySelector('meta[property="csp-nonce"]');this._nonce=c?c.getAttribute("content"):null}var e,s=StyleSheet.prototype;return s.setOptimizeForSpeed=function(e){invariant$1("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),invariant$1(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},s.isOptimizeForSpeed=function(){return this._optimizeForSpeed},s.inject=function(){var e=this;if(invariant$1(!this._injected,"sheet already injected"),this._injected=!0,this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(r||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(s,t){return"number"==typeof t?e._serverSheet.cssRules[t]={cssText:s}:e._serverSheet.cssRules.push({cssText:s}),t},deleteRule:function(s){e._serverSheet.cssRules[s]=null}}},s.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].ownerNode===e)return document.styleSheets[s]},s.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},s.insertRule=function(e,s){if(invariant$1(isString(e),"`insertRule` accepts only strings"),this._optimizeForSpeed){var t=this.getSheet();"number"!=typeof s&&(s=t.cssRules.length);try{t.insertRule(e,s)}catch(s){return r||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var n=this._tags[s];this._tags.push(this.makeStyleTag(this._name,e,n))}return this._rulesCount++},s.replaceRule=function(e,s){if(this._optimizeForSpeed){var t=this.getSheet();if(s.trim()||(s=this._deletedRulePlaceholder),!t.cssRules[e])return e;t.deleteRule(e);try{t.insertRule(s,e)}catch(n){r||console.warn("StyleSheet: illegal rule: \n\n"+s+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),t.insertRule(this._deletedRulePlaceholder,e)}}else{var n=this._tags[e];invariant$1(n,"old rule at index `"+e+"` not found"),n.textContent=s}return e},s.deleteRule=function(e){if(this._optimizeForSpeed)this.replaceRule(e,"");else{var s=this._tags[e];invariant$1(s,"rule at index `"+e+"` not found"),s.parentNode.removeChild(s),this._tags[e]=null}},s.flush=function(){this._injected=!1,this._rulesCount=0,this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]},s.cssRules=function(){var e=this;return this._tags.reduce(function(s,t){return t?s=s.concat(Array.prototype.map.call(e.getSheetForTag(t).cssRules,function(s){return s.cssText===e._deletedRulePlaceholder?null:s})):s.push(null),s},[])},s.makeStyleTag=function(e,s,t){s&&invariant$1(isString(s),"makeStyleTag accepts only strings as second parameter");var n=document.createElement("style");this._nonce&&n.setAttribute("nonce",this._nonce),n.type="text/css",n.setAttribute("data-"+e,""),s&&n.appendChild(document.createTextNode(s));var i=document.head||document.getElementsByTagName("head")[0];return t?i.insertBefore(n,t):i.appendChild(n),n},_defineProperties(StyleSheet.prototype,[{key:"length",get:function(){return this._rulesCount}}]),e&&_defineProperties(StyleSheet,e),StyleSheet}();function invariant$1(e,s){if(!e)throw Error("StyleSheet: "+s+".")}var stringHash=function(e){for(var s=5381,t=e.length;t;)s=33*s^e.charCodeAt(--t);return s>>>0},l={};function computeId(e,s){if(!s)return"jsx-"+e;var t=String(s),n=e+t;return l[n]||(l[n]="jsx-"+stringHash(e+"-"+t)),l[n]}function computeSelector(e,s){var t=e+s;return l[t]||(l[t]=s.replace(/__jsx-style-dynamic-selector/g,e)),l[t]}var o=function(){function StyleSheetRegistry(e){var s=void 0===e?{}:e,t=s.styleSheet,n=void 0===t?null:t,i=s.optimizeForSpeed,a=void 0!==i&&i;this._sheet=n||new c({name:"styled-jsx",optimizeForSpeed:a}),this._sheet.inject(),n&&"boolean"==typeof a&&(this._sheet.setOptimizeForSpeed(a),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var e=StyleSheetRegistry.prototype;return e.add=function(e){var s=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,s){return e[s]=0,e},{}));var t=this.getIdAndRules(e),n=t.styleId,i=t.rules;if(n in this._instancesCounts){this._instancesCounts[n]+=1;return}var a=i.map(function(e){return s._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[n]=a,this._instancesCounts[n]=1},e.remove=function(e){var s=this,t=this.getIdAndRules(e).styleId;if(function(e,s){if(!e)throw Error("StyleSheetRegistry: "+s+".")}(t in this._instancesCounts,"styleId: `"+t+"` not found"),this._instancesCounts[t]-=1,this._instancesCounts[t]<1){var n=this._fromServer&&this._fromServer[t];n?(n.parentNode.removeChild(n),delete this._fromServer[t]):(this._indices[t].forEach(function(e){return s._sheet.deleteRule(e)}),delete this._indices[t]),delete this._instancesCounts[t]}},e.update=function(e,s){this.add(s),this.remove(e)},e.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},e.cssRules=function(){var e=this,s=this._fromServer?Object.keys(this._fromServer).map(function(s){return[s,e._fromServer[s]]}):[],t=this._sheet.cssRules();return s.concat(Object.keys(this._indices).map(function(s){return[s,e._indices[s].map(function(e){return t[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},e.styles=function(e){var s,t;return s=this.cssRules(),void 0===(t=e)&&(t={}),s.map(function(e){var s=e[0],n=e[1];return a.default.createElement("style",{id:"__"+s,key:"__"+s,nonce:t.nonce?t.nonce:void 0,dangerouslySetInnerHTML:{__html:n}})})},e.getIdAndRules=function(e){var s=e.children,t=e.dynamic,n=e.id;if(t){var i=computeId(n,t);return{styleId:i,rules:Array.isArray(s)?s.map(function(e){return computeSelector(i,e)}):[computeSelector(i,s)]}}return{styleId:computeId(n),rules:Array.isArray(s)?s:[s]}},e.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,s){return e[s.id.slice(2)]=s,e},{})},StyleSheetRegistry}(),h=i.createContext(null);h.displayName="StyleSheetContext";var d=a.default.useInsertionEffect||a.default.useLayoutEffect,x=new o;function JSXStyle(e){var s=x||i.useContext(h);return s&&d(function(){return s.add(e),function(){s.remove(e)}},[e.id,String(e.dynamic)]),null}JSXStyle.dynamic=function(e){return e.map(function(e){return computeId(e[0],e[1])}).join(" ")},s.style=JSXStyle},65910:function(e,s,t){"use strict";e.exports=t(96139).style},26228:function(){}},function(e){e.O(0,[3220,1589,9774,2888,179],function(){return e(e.s=69440)}),_N_E=e.O()}]);