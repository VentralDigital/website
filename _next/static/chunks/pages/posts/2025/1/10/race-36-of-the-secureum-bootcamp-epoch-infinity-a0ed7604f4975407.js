(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6896],{77251:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/2025/1/10/race-36-of-the-secureum-bootcamp-epoch-infinity",function(){return n(87904)}])},64751:function(e,s){"use strict";s.Z={src:"/_next/static/media/secureum-banner.b3ad8557.jpg",height:630,width:1200,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCAAEAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAbEAACAgMBAAAAAAAAAAAAAAAAAgEDBCEyE//EABUBAQEAAAAAAAAAAAAAAAAAAAQF/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAECEf/aAAwDAQACEQMRAD8AnGFcviyPjUWS1PTJuOtgAcT9auj/2Q==",blurWidth:8,blurHeight:4}},87904:function(e,s,n){"use strict";n.r(s),n.d(s,{HiddenSolution:function(){return HiddenSolution},__toc:function(){return p}});var i=n(35250),l=n(65910),r=n.n(l),t=n(47147),a=n(77298),c=n(18363),o=n(30746),h=n.n(o),d=n(64751),x=n(13423);function HiddenSolution(e){let{children:s}=e,n=Object.assign({details:"details",summary:"summary",strong:"strong",div:"div"},(0,a.a)());return(0,i.jsxs)(n.details,{closed:!0,className:"last-of-type:mb-0 rounded-lg bg-neutral-50 dark:bg-neutral-800 p-2 mt-4",children:[(0,i.jsx)(n.summary,{children:(0,i.jsx)(n.strong,{className:"text-lg",children:"Solution"})}),(0,i.jsx)(n.div,{className:"nx-p-2",children:s})]})}let p=[{depth:3,value:"Code Snippet #1",id:"code-snippet-1"},{depth:3,value:"Question 1 of 8",id:"question-1-of-8"},{depth:3,value:"Question 2 of 8",id:"question-2-of-8"},{depth:3,value:"Question 3 of 8",id:"question-3-of-8"},{depth:3,value:"Question 4 of 8",id:"question-4-of-8"},{depth:3,value:"Question 5 of 8",id:"question-5-of-8"},{depth:3,value:"Code Snippet #2",id:"code-snippet-2"},{depth:3,value:"Question 6 of 8",id:"question-6-of-8"},{depth:3,value:"Question 7 of 8",id:"question-7-of-8"},{depth:3,value:"Question 8 of 8",id:"question-8-of-8"}];function _createMdxContent(e){let s=Object.assign({h1:"h1",p:"p",a:"a",strong:"strong",hr:"hr",h3:"h3",pre:"pre",code:"code",span:"span"},(0,a.a)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h1,{children:"RACE #36 Of The Secureum Bootcamp Epoch∞"}),"\n","\n",(0,i.jsxs)(h(),{children:[(0,i.jsx)("meta",{property:"og:image",content:"https://ventral.digital"+d.Z.src,className:"jsx-ea2c409626c7be76"}),(0,i.jsx)("meta",{name:"twitter:image",content:"https://ventral.digital"+d.Z.src,className:"jsx-ea2c409626c7be76"})]}),"\n",(0,i.jsxs)(s.p,{children:["This is the official solution of RACE-36, Quiz of the ",(0,i.jsx)(s.a,{href:"https://twitter.com/0xRajeev/status/1470910752085065731",children:"Secureum Bootcamp"})," for Ethereum Smart Contract Auditors. Answers and explanations have been provided by the author ",(0,i.jsx)(s.a,{href:"https://x.com/zigtur",children:"Zigtur"}),", an independent security researcher and colleague at Spearbit."]}),"\n",(0,i.jsxs)(c.UW,{type:"info",children:[(0,i.jsxs)(s.p,{children:["Participants of this quiz had a single attempt to ",(0,i.jsx)(s.strong,{children:"answer 8 questions within the strict time limit of 16 minutes"}),". If you’re reading this in preparation for participating yourself, it’s best to give it a try under the same time limit!"]}),(0,i.jsx)(s.p,{children:"As usual, I waited for submissions to close before publishing it and, to stay true to the original, I omitted syntax highlighting. Feel free to copy it into your favorite editor, but do so after starting the timer!"})]}),"\n",(0,i.jsxs)("p",{className:"jsx-ea2c409626c7be76 text-xs text-right",children:["January 10, 2025 by ",(0,i.jsx)(s.a,{href:"https://x.com/zigtur",children:"Zigtur"})]}),"\n",(0,i.jsx)(r(),{id:"ea2c409626c7be76",children:"input[type=checkbox].jsx-ea2c409626c7be76{width:15px;height:15px}li.jsx-ea2c409626c7be76{padding:.5em}"}),"\n","\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"code-snippet-1",children:"Code Snippet #1"}),"\n",(0,i.jsx)(c.UW,{type:"info",children:(0,i.jsx)(s.p,{children:"All 8 questions refer to the following library."})}),"\n",(0,i.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",filename:"BN128.sol",children:(0,i.jsxs)(s.code,{"data-line-numbers":"","data-language":"plaintext","data-theme":"default","data-line-numbers-max-digits":"3",children:[(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// SPDX-License-Identifier: UNLICENSED"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"pragma solidity 0.8.20;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"library BN128Verifier {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   struct G1Point {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256 X;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256 Y;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   struct G2Point {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256[2] X;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256[2] Y;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function G1() internal pure returns (G1Point memory) {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       return G1Point(1, 2);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   /// Generator point in F_p2"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   uint256 internal constant x1G2 ="})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       11559732032986387107991004021392285783925812861821192530917403151452391805634;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   uint256 internal constant x0G2 ="})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       10857046999023057135944570762232829481370756359578518086990519993285655852781;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   uint256 internal constant y1G2 ="})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       4082367875863433681332203403145435568316851327593401208105741076214120093531;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   uint256 internal constant y0G2 ="})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       8495653923123431417604973247489272438418190587263600148770280649306958101930;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function G2() internal pure returns (G2Point memory) {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       return G2Point([x1G2, x0G2], [y1G2, y0G2]);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   /// Negative generator G2"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   uint256 internal constant x1nG2 ="})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       11559732032986387107991004021392285783925812861821192530917403151452391805634;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   uint256 internal constant x0nG2 ="})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       10857046999023057135944570762232829481370756359578518086990519993285655852781;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   uint256 internal constant y1nG2 ="})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       17805874995975841540914202342111839520379459829704422454583296818431106115052;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   uint256 internal constant y0nG2 ="})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       13392588948715843804641432497768002650278120570034223513918757245338268106653;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function negG2() internal pure returns (G2Point memory) {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       return G2Point([x1nG2, x0nG2], [y1nG2, y0nG2]);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function add("})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory a,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory b"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   ) internal view returns (G1Point memory output) {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256[4] memory input;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[0] = a.X;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[1] = a.Y;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[2] = b.X;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[3] = b.Y;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       bool success;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       assembly {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           success := staticcall(gas(), 6, input, 0x80, output, 0x40)"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'       require(success, "alt_bn128: add failed");'})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function eq("})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory a,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory b"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   ) internal view returns (bool) {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       return (a.X == b.X && a.Y == b.Y);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function mul("})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory a,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256 scalar"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   ) internal view returns (G1Point memory output) {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256[3] memory input;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[0] = a.X;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[1] = a.Y;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[2] = scalar;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       bool success;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       assembly {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           success := staticcall(gas(), 7, input, 0x60, output, 0x40)"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'       require(success, "alt_bn128: mul failed");'})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function pairing("})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory a,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G2Point memory b,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory c,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G2Point memory d"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   ) internal view returns (bool output) {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256[12] memory input;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[0] = a.X;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[1] = a.Y;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[2] = b.X[0];"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[3] = b.X[1];"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[4] = b.Y[0];"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[5] = b.Y[1];"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[6] = c.X;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[7] = c.Y;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[8] = d.X[0];"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[9] = d.X[1];"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[10] = d.Y[0];"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       input[11] = d.Y[1];"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       bool success;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       assembly {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"           success := staticcall(gas(), 8, input, 0x180, input, 0x20)"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'       require(success, "alt_bn128: pairing failed");'})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       output = input[0] != 0;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function verifyPubkeyMatching("})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory publicKeyG1,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G2Point memory publicKeyG2"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   ) public view returns (bool valid) {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256 pseudorandom = uint256(keccak256(abi.encode(publicKeyG1, publicKeyG2, block.timestamp, block.prevrandao)));"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory keyTester = mul(G1(), pseudorandom);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       valid = pairing(mul(publicKeyG1, pseudorandom), negG2(), keyTester, publicKeyG2);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'       require(valid, "Mismatch: publicKeyG1 / publicKeyG2");'})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function verifySignature("})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory publicKeyG1,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G2Point memory publicKeyG2,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory signature,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256 sigHash"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   ) public view returns (bool valid) {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       verifyPubkeyMatching(publicKeyG1, publicKeyG2);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256 pseudorandom = uint256(keccak256(abi.encode(publicKeyG1, publicKeyG2, signature, block.timestamp, block.prevrandao)));"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory sigTester = mul(G1(), pseudorandom);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       valid = pairing(mul(signature, pseudorandom), negG2(), mul(mul(G1(), pseudorandom), sigHash), publicKeyG2);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'       require(valid, "Invalid signature");'})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,i.jsx)(s.h3,{id:"question-1-of-8",children:"Question 1 of 8"}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"alt_bn128"}),"/",(0,i.jsx)(s.code,{children:"bn254"})," curve is the only pairing-friendly curve supported in the EVM through a precompile. What is it mainly used for?"]}),"\n",(0,i.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. zk-SNARKs "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. zk-STARKs "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Schnorr multi-signatures "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. BLS multi-signatures "]})]}),"\n",(0,i.jsxs)(HiddenSolution,{children:[(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Correct is A, D."})}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"A"}),": True, this curve is used for zk-SNARKs like Groth16. A good ressource for Groth16 and ZK is the ",(0,i.jsx)(s.a,{href:"https://www.rareskills.io/zk-book",children:"ZK book"})," by Rareskills."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"B"}),": False. STARKs rely on hash functions and not on elliptic curves. The ",(0,i.jsx)(s.a,{href:"https://starkware.co/stark-101/",children:"STARK101 course"})," by Starknet is a good ressource to get started."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"C"}),": False. ",(0,i.jsx)(s.a,{href:"https://en.bitcoin.it/wiki/Schnorr",children:"Schnorr"})," multi-signature is a digital signature algorithm used in Bitcoin. It allows multi-signature with SECP256K1."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"D"}),": True, the curve can be used for BLS multi signatures. This signature scheme is really useful for validators (Ethereum consensus uses it with another curve)."]}),(0,i.jsx)(s.p,{children:"These signatures are based on bilinear pairings. It allows aggregating pubkeys and signatures through addition to make a single signature verification through pairing."}),(0,i.jsx)(s.p,{children:"For example, if there are 100 validators that sign the same data, ECDSA will require verifying 100 signatures. BLS signatures allow to aggregate the pubkeys and signatures into a single pubkey-signature pair. This single aggregated signature is verified with the single aggregated pubkey."})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"question-2-of-8",children:"Question 2 of 8"}),"\n",(0,i.jsxs)(s.p,{children:["Which of the following curve is the most similar to ",(0,i.jsx)(s.code,{children:"alt_bn128"}),"/",(0,i.jsx)(s.code,{children:"bn254"}),":"]}),"\n",(0,i.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. ",(0,i.jsx)(s.code,{children:"secp256k1"})," "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. ",(0,i.jsx)(s.code,{children:"ed25519"})," "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. ",(0,i.jsx)(s.code,{children:"bls12-381"})," "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. ",(0,i.jsx)(s.code,{children:"brainpoolP256r1"})," "]})]}),"\n",(0,i.jsxs)(HiddenSolution,{children:[(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Correct is C."})}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"A/B/D"}),": False, it is not a pairing friendly elliptic curve."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"C"}),": True, both are pairing-friendly elliptic curves."]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"question-3-of-8",children:"Question 3 of 8"}),"\n",(0,i.jsxs)(s.p,{children:["Which Ethereum projects rely on the ",(0,i.jsx)(s.code,{children:"alt_bn128"}),"/",(0,i.jsx)(s.code,{children:"bn254"})," curve?"]}),"\n",(0,i.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. Tornado Cash "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. EigenLayer "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. AAVE "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. KyberSwap "]})]}),"\n",(0,i.jsxs)(HiddenSolution,{children:[(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Correct is A, B."})}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"A"}),": True, ZK purposes."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"B"}),": True, EigenLayer with EigenDA. EigenDA uses it to verify aggregated (BLS) signatures for AVS."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"C/D"}),": False. They are DeFi protocols and don't use multi-signature or ZK."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"alt_bn128"})," elliptic curve is used for ZK purposes. It is used with the Groth16 ZK algorithm to make private transfers."]}),(0,i.jsxs)(s.p,{children:["Despite ",(0,i.jsx)(s.code,{children:"bls12-381"})," curve being used in the Ethereum consensus, it is not supported inside of the EVM. The only ZK-friendly curve in EVM is ",(0,i.jsx)(s.code,{children:"alt_bn128"}),", which is why it is used by Tornado Cash."]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"question-4-of-8",children:"Question 4 of 8"}),"\n",(0,i.jsxs)(s.p,{children:["There are 3 EVM precompiles for operations on the ",(0,i.jsx)(s.code,{children:"alt_bn128"})," curve. Which statements are true?"]}),"\n",(0,i.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. ",(0,i.jsx)(s.code,{children:"ecDiv"})," precompile allows dividing a point by another point "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. ",(0,i.jsx)(s.code,{children:"ecAdd"})," allows adding a scalar to a point and adding two points together. "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. ",(0,i.jsx)(s.code,{children:"ecMul"})," only allows multiplying a point and a scalar. "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. ",(0,i.jsx)(s.code,{children:"ecMul"})," expects point input in compressed format. "]})]}),"\n",(0,i.jsxs)(HiddenSolution,{children:[(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Correct is C."})}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"A"}),": False. Division does not exist in elliptic curve calculations."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"B"}),": False. Elliptic curve only supports addition of two points and not addition of a point and a scalar."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"C"}),": True, elliptic curves define multiplication as an operation between a point and a scalar."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"D"}),": False. ",(0,i.jsx)(s.code,{children:"ecAdd"}),", ",(0,i.jsx)(s.code,{children:"ecMul"})," and ",(0,i.jsx)(s.code,{children:"ecPairing"})," precompiles support operations on uncompressed format points."]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"question-5-of-8",children:"Question 5 of 8"}),"\n",(0,i.jsxs)(s.p,{children:["With ",(0,i.jsx)(s.code,{children:"e"})," being the pairing function, ",(0,i.jsx)(s.code,{children:"H"})," being the message hash, ",(0,i.jsx)(s.code,{children:"sk"})," being a secret key and ",(0,i.jsx)(s.code,{children:"r"})," being a random, which formula(s) verify a signature?"]}),"\n",(0,i.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. ",(0,i.jsx)(s.code,{children:"e([sk * H]_1, -[1]_2) + e([H]_1, [sk]_2) == 0"})," "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. ",(0,i.jsx)(s.code,{children:"e([sk * H]_1, [1]_2) ==  e([H]_1, [sk]_2)"})," "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. ",(0,i.jsx)(s.code,{children:"e([sk * H]_1 * r, [1]_2) ==  e([H]_1, [sk]_2 * r)"})," "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. ",(0,i.jsx)(s.code,{children:"e([sk * H]_1, [r]_2) + e([H * r]_1, [sk]_2) == 0"})," "]})]}),"\n",(0,i.jsxs)(HiddenSolution,{children:[(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Correct is A, B, C."})}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"A"}),": True, this is the equation that the ",(0,i.jsx)(s.code,{children:"ecPairing"})," precompile will verify for a signature."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"B"}),": True, equivalent to option A. It is equivalent due to bilinear pairing properties. The ",(0,i.jsx)(s.code,{children:"ecPairing"})," precompile is not able to handle such calculations though. The first equation form (Answer A) should be used."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"C"}),": True, a random can be added during signature verification. Due to pairing properties, a random ",(0,i.jsx)(s.code,{children:"r"})," can be added on both sides of the equation without breaking it."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"D"}),": False, the random is added on both side, however one of them should be negative for the equation to be zero."]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"code-snippet-2",children:"Code Snippet #2"}),"\n",(0,i.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",filename:"Validators.sol",children:(0,i.jsxs)(s.code,{"data-line-numbers":"","data-language":"plaintext","data-theme":"default","data-line-numbers-max-digits":"2",children:[(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"// SPDX-License-Identifier: UNLICENSED"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"pragma solidity 0.8.20;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'import {BN128Verifier} from "./BN128.sol";'})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"contract Validators {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   using BN128Verifier for BN128Verifier.G1Point;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   using BN128Verifier for BN128Verifier.G2Point;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   address owner;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   BN128Verifier.G1Point aggPubkeys;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   BN128Verifier.G1Point pendingPubkey;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   mapping(bytes32 => bool) validSignature;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   constructor() {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       owner = msg.sender;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function registerValidator(BN128Verifier.G1Point memory pubkeyToAdd) external {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'       require(pendingPubkey.eq(BN128Verifier.G1()), "pending pubkey already set");'})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       pendingPubkey = pubkeyToAdd;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function aggregateValidator() external {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'       require(msg.sender == owner, "only owner");'})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'       require(!pendingPubkey.eq(BN128Verifier.G1()), "empty pending");'})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       aggPubkeys = aggPubkeys.add(pendingPubkey);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       // reset pending pubkey"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       pendingPubkey = BN128Verifier.G1();"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function validateSignature(bytes memory message, BN128Verifier.G1Point memory signature, BN128Verifier.G2Point memory g2AggPubkey) public view returns (bool) {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       bytes32 hashed = keccak256(message);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       bool valid = BN128Verifier.verifySignature(aggPubkeys, g2AggPubkey, signature, hashed);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       bytes32 hashedSig = keccak256(signature);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       validSignature[hashedSig] = valid;"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,i.jsx)(c.UW,{type:"info",children:(0,i.jsxs)(s.p,{children:["Note that in the original RACE the code of the ",(0,i.jsx)(s.code,{children:"validateSignature"})," function couldn't compile due to a check on the ",(0,i.jsx)(s.code,{children:"hashed"})," variable which wasn't initialized and wasn't setting the ",(0,i.jsx)(s.code,{children:"valid"})," boolean in storage. The issue is corrected above and had no impact on the answers."]})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"question-6-of-8",children:"Question 6 of 8"}),"\n",(0,i.jsx)(s.p,{children:"What is true about the given Validators contract?"}),"\n",(0,i.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. No validator is able to register. "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. Only owner is able to aggregate a validator. "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. Malicious validator can break aggregation. "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. Ownership is transferable "]})]}),"\n",(0,i.jsxs)(HiddenSolution,{children:[(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Correct is A, B, C."})}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"A"}),": True, ",(0,i.jsx)(s.code,{children:"registerValidator"})," require the ",(0,i.jsx)(s.code,{children:"pendingPubkey"})," to be ",(0,i.jsx)(s.code,{children:"G1"}),", but this is not initialized in constructor. This is because ",(0,i.jsx)(s.code,{children:"G1"})," is not ",(0,i.jsx)(s.code,{children:"(0, 0)"}),". ",(0,i.jsx)(s.code,{children:"G1"})," is expected to be ",(0,i.jsx)(s.code,{children:"(1, 2)"}),"."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"B"}),": True, owner check is done through require."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"C"}),": True, by using ",(0,i.jsx)(s.code,{children:"registerValidator"})," with an incorrect pubkey, caller will break ",(0,i.jsx)(s.code,{children:"aggregateValidator"})," (permanent DOS): ",(0,i.jsx)(s.code,{children:"aggregateValidator"})," will not work because the ",(0,i.jsx)(s.code,{children:"pendingPubkey"})," is not a point that satisfies the BN256 elliptic curve equation. It is not a valid point. When adding a valid point with an invalid point, the addition will fail."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"D"}),": False. There is no such functionality in the contract."]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"question-7-of-8",children:"Question 7 of 8"}),"\n",(0,i.jsxs)(s.p,{children:["What is true about ",(0,i.jsx)(s.code,{children:"validateSignature"}),"?"]}),"\n",(0,i.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. It requires 2/3 of validators' signatures "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. It is prone to signature malleability "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. It requires all validators' signatures "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. A signature marked as valid will always remain valid "]})]}),"\n",(0,i.jsxs)(HiddenSolution,{children:[(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Correct is C."})}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"A"}),": False. A threshold mechanism could have been set with BLS signatures by subtracting the non-signer pubkeys from the aggregated pubkey to obtain a 2/3 threshold."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"B"}),": False, BLS signatures are not prone to signature malleability."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"C"}),": True, all validators must sign for the signature to be valid with the aggregated pubkey. The aggregated pubkey is the sum of all validators pubkey. For a signature to be valid with this aggregated pubkey, it must be the sum of all validators signature. If one of the signature is invalid (e.g. the data signed is not the same), then the whole aggregated signature is invalid."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"D"}),": False, if a validator is added, the ",(0,i.jsx)(s.code,{children:"aggPubkeys"})," change and the signature can be reset to false in the mapping."]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"question-8-of-8",children:"Question 8 of 8"}),"\n",(0,i.jsx)(s.pre,{"data-language":"plaintext","data-theme":"default",children:(0,i.jsxs)(s.code,{"data-line-numbers":"","data-language":"plaintext","data-theme":"default","data-line-numbers-max-digits":"2",children:[(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   function verifySignature("})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory publicKeyG1,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G2Point memory publicKeyG2,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory signature,"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256 sigHash"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   ) public view returns (bool valid) {"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       uint256 pseudorandom = uint256(keccak256(abi.encode(publicKeyG1, publicKeyG2, signature, block.timestamp, block.prevrandao)));"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       G1Point memory sigTester = mul(G1(), pseudorandom);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"}})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"       valid = pairing(mul(signature, pseudorandom), negG2(), mul(G1(), sigHash), publicKeyG2);"})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:'       require(valid, "Invalid signature");'})}),"\n",(0,i.jsx)(s.span,{className:"line",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"   }"})})]})}),"\n",(0,i.jsxs)(s.p,{children:["What is true about ",(0,i.jsx)(s.code,{children:"verifySignature"}),"?"]}),"\n",(0,i.jsxs)("ul",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," A. The pseudorandom used in the pairing validation is not needed for verifying the signature "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," B. The function ensures that the G1 public key matches with the G2 public key "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," C. The function will revert for incorrect signatures. "]}),(0,i.jsxs)("li",{className:"jsx-ea2c409626c7be76",children:[(0,i.jsx)("input",{type:"checkbox",className:"jsx-ea2c409626c7be76"})," D. The function will revert for correct signatures. "]})]}),"\n",(0,i.jsxs)(HiddenSolution,{children:[(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Correct is A, C, D."})}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"A"}),": True, it can be removed or kept to test the signature validity, as long as equation is adapted."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"B"}),": False. There is no such check."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"C"}),": True, it will revert everytime for both valid and invalid signatures."]}),(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"D"}),": True. The pseudorandom is included in the first element of the equation but not in the second part. It is equivalent to ",(0,i.jsx)(s.code,{children:"e([sk * H * r]_1, [-1]_2) + e([H]_1, [sk]_2)"}),"."]}),(0,i.jsxs)(s.p,{children:["The pairing never resolves into ",(0,i.jsx)(s.code,{children:"== 0"})," and wil never be valid."]}),(0,i.jsxs)(s.p,{children:["The code to verify correct signatures: ",(0,i.jsx)(s.code,{children:"valid = pairing(mul(signature, pseudorandom), negG2(), mul(mul(G1(), sigHash), pseudorandom), publicKeyG2);"})]})]}),"\n",(0,i.jsx)(s.hr,{}),"\n","\n",(0,i.jsx)(c.oy,{children:(0,i.jsx)(c.Zb,{icon:(0,i.jsx)(x.H8,{}),title:"← RACE #35 Of The Secureum Bootcamp Epoch∞",href:"/posts/2024/12/10/race-35-of-the-secureum-bootcamp-epoch-infinity/"})})]})}s.default=(0,t.j)({MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,a.a)(),e.components);return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/posts/2025/1/10/race-36-of-the-secureum-bootcamp-epoch-infinity.mdx",route:"/posts/2025/1/10/race-36-of-the-secureum-bootcamp-epoch-infinity",timestamp:1736535047e3,title:"RACE #36 Of The Secureum Bootcamp Epoch∞",headings:p},pageNextRoute:"/posts/2025/1/10/race-36-of-the-secureum-bootcamp-epoch-infinity"})},96139:function(e,s,n){var i=n(94869);n(26228);var l=n(70079),r=l&&"object"==typeof l&&"default"in l?l:{default:l};function _defineProperties(e,s){for(var n=0;n<s.length;n++){var i=s[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var t=void 0!==i&&i.env&&!0,isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},a=function(){function StyleSheet(e){var s=void 0===e?{}:e,n=s.name,i=void 0===n?"stylesheet":n,l=s.optimizeForSpeed,r=void 0===l?t:l;invariant$1(isString(i),"`name` must be a string"),this._name=i,this._deletedRulePlaceholder="#"+i+"-deleted-rule____{}",invariant$1("boolean"==typeof r,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=r,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var a=document.querySelector('meta[property="csp-nonce"]');this._nonce=a?a.getAttribute("content"):null}var e,s=StyleSheet.prototype;return s.setOptimizeForSpeed=function(e){invariant$1("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),invariant$1(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},s.isOptimizeForSpeed=function(){return this._optimizeForSpeed},s.inject=function(){var e=this;if(invariant$1(!this._injected,"sheet already injected"),this._injected=!0,this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(t||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(s,n){return"number"==typeof n?e._serverSheet.cssRules[n]={cssText:s}:e._serverSheet.cssRules.push({cssText:s}),n},deleteRule:function(s){e._serverSheet.cssRules[s]=null}}},s.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].ownerNode===e)return document.styleSheets[s]},s.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},s.insertRule=function(e,s){if(invariant$1(isString(e),"`insertRule` accepts only strings"),this._optimizeForSpeed){var n=this.getSheet();"number"!=typeof s&&(s=n.cssRules.length);try{n.insertRule(e,s)}catch(s){return t||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var i=this._tags[s];this._tags.push(this.makeStyleTag(this._name,e,i))}return this._rulesCount++},s.replaceRule=function(e,s){if(this._optimizeForSpeed){var n=this.getSheet();if(s.trim()||(s=this._deletedRulePlaceholder),!n.cssRules[e])return e;n.deleteRule(e);try{n.insertRule(s,e)}catch(i){t||console.warn("StyleSheet: illegal rule: \n\n"+s+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),n.insertRule(this._deletedRulePlaceholder,e)}}else{var i=this._tags[e];invariant$1(i,"old rule at index `"+e+"` not found"),i.textContent=s}return e},s.deleteRule=function(e){if(this._optimizeForSpeed)this.replaceRule(e,"");else{var s=this._tags[e];invariant$1(s,"rule at index `"+e+"` not found"),s.parentNode.removeChild(s),this._tags[e]=null}},s.flush=function(){this._injected=!1,this._rulesCount=0,this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]},s.cssRules=function(){var e=this;return this._tags.reduce(function(s,n){return n?s=s.concat(Array.prototype.map.call(e.getSheetForTag(n).cssRules,function(s){return s.cssText===e._deletedRulePlaceholder?null:s})):s.push(null),s},[])},s.makeStyleTag=function(e,s,n){s&&invariant$1(isString(s),"makeStyleTag accepts only strings as second parameter");var i=document.createElement("style");this._nonce&&i.setAttribute("nonce",this._nonce),i.type="text/css",i.setAttribute("data-"+e,""),s&&i.appendChild(document.createTextNode(s));var l=document.head||document.getElementsByTagName("head")[0];return n?l.insertBefore(i,n):l.appendChild(i),i},_defineProperties(StyleSheet.prototype,[{key:"length",get:function(){return this._rulesCount}}]),e&&_defineProperties(StyleSheet,e),StyleSheet}();function invariant$1(e,s){if(!e)throw Error("StyleSheet: "+s+".")}var stringHash=function(e){for(var s=5381,n=e.length;n;)s=33*s^e.charCodeAt(--n);return s>>>0},c={};function computeId(e,s){if(!s)return"jsx-"+e;var n=String(s),i=e+n;return c[i]||(c[i]="jsx-"+stringHash(e+"-"+n)),c[i]}function computeSelector(e,s){var n=e+s;return c[n]||(c[n]=s.replace(/__jsx-style-dynamic-selector/g,e)),c[n]}var o=function(){function StyleSheetRegistry(e){var s=void 0===e?{}:e,n=s.styleSheet,i=void 0===n?null:n,l=s.optimizeForSpeed,r=void 0!==l&&l;this._sheet=i||new a({name:"styled-jsx",optimizeForSpeed:r}),this._sheet.inject(),i&&"boolean"==typeof r&&(this._sheet.setOptimizeForSpeed(r),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var e=StyleSheetRegistry.prototype;return e.add=function(e){var s=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,s){return e[s]=0,e},{}));var n=this.getIdAndRules(e),i=n.styleId,l=n.rules;if(i in this._instancesCounts){this._instancesCounts[i]+=1;return}var r=l.map(function(e){return s._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[i]=r,this._instancesCounts[i]=1},e.remove=function(e){var s=this,n=this.getIdAndRules(e).styleId;if(function(e,s){if(!e)throw Error("StyleSheetRegistry: "+s+".")}(n in this._instancesCounts,"styleId: `"+n+"` not found"),this._instancesCounts[n]-=1,this._instancesCounts[n]<1){var i=this._fromServer&&this._fromServer[n];i?(i.parentNode.removeChild(i),delete this._fromServer[n]):(this._indices[n].forEach(function(e){return s._sheet.deleteRule(e)}),delete this._indices[n]),delete this._instancesCounts[n]}},e.update=function(e,s){this.add(s),this.remove(e)},e.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},e.cssRules=function(){var e=this,s=this._fromServer?Object.keys(this._fromServer).map(function(s){return[s,e._fromServer[s]]}):[],n=this._sheet.cssRules();return s.concat(Object.keys(this._indices).map(function(s){return[s,e._indices[s].map(function(e){return n[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},e.styles=function(e){var s,n;return s=this.cssRules(),void 0===(n=e)&&(n={}),s.map(function(e){var s=e[0],i=e[1];return r.default.createElement("style",{id:"__"+s,key:"__"+s,nonce:n.nonce?n.nonce:void 0,dangerouslySetInnerHTML:{__html:i}})})},e.getIdAndRules=function(e){var s=e.children,n=e.dynamic,i=e.id;if(n){var l=computeId(i,n);return{styleId:l,rules:Array.isArray(s)?s.map(function(e){return computeSelector(l,e)}):[computeSelector(l,s)]}}return{styleId:computeId(i),rules:Array.isArray(s)?s:[s]}},e.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,s){return e[s.id.slice(2)]=s,e},{})},StyleSheetRegistry}(),h=l.createContext(null);h.displayName="StyleSheetContext";var d=r.default.useInsertionEffect||r.default.useLayoutEffect,x=new o;function JSXStyle(e){var s=x||l.useContext(h);return s&&d(function(){return s.add(e),function(){s.remove(e)}},[e.id,String(e.dynamic)]),null}JSXStyle.dynamic=function(e){return e.map(function(e){return computeId(e[0],e[1])}).join(" ")},s.style=JSXStyle},65910:function(e,s,n){"use strict";e.exports=n(96139).style},26228:function(){}},function(e){e.O(0,[3220,1589,9774,2888,179],function(){return e(e.s=77251)}),_N_E=e.O()}]);